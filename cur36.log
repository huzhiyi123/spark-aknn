nohup: ignoring input
/aknn/alllog/1/1/36.log
Ivy Default Cache set to: /root/.ivy2/cache
The jars for the packages stored in: /root/.ivy2/jars
:: loading settings :: url = jar:file:/usr/spark-2.4.1/jars/ivy-2.4.0.jar!/org/apache/ivy/core/settings/ivysettings.xml
com.github.jelmerk#hnswlib-spark_2.4_2.11 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-45da940b-926e-483a-b54c-9e2273cf2721;1.0
	confs: [default]
	found com.github.jelmerk#hnswlib-spark_2.4_2.11;1.0.0 in central
	found com.github.jelmerk#hnswlib-utils;1.0.0 in central
	found com.github.jelmerk#hnswlib-scala_2.11;1.0.0 in central
	found com.github.jelmerk#hnswlib-core;1.0.0 in central
	found org.eclipse.collections#eclipse-collections;9.2.0 in central
	found org.eclipse.collections#eclipse-collections-api;9.2.0 in central
:: resolution report :: resolve 392ms :: artifacts dl 13ms
	:: modules in use:
	com.github.jelmerk#hnswlib-core;1.0.0 from central in [default]
	com.github.jelmerk#hnswlib-scala_2.11;1.0.0 from central in [default]
	com.github.jelmerk#hnswlib-spark_2.4_2.11;1.0.0 from central in [default]
	com.github.jelmerk#hnswlib-utils;1.0.0 from central in [default]
	org.eclipse.collections#eclipse-collections;9.2.0 from central in [default]
	org.eclipse.collections#eclipse-collections-api;9.2.0 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   6   |   0   |   0   |   0   ||   6   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-45da940b-926e-483a-b54c-9e2273cf2721
	confs: [default]
	0 artifacts copied, 6 already retrieved (0kB/10ms)
2022-01-26 14:43:19,852 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2022-01-26 14:43:22,280 INFO spark.SparkContext: Running Spark version 2.4.1
2022-01-26 14:43:22,304 INFO spark.SparkContext: Submitted application: mytest
2022-01-26 14:43:22,360 INFO spark.SecurityManager: Changing view acls to: root
2022-01-26 14:43:22,361 INFO spark.SecurityManager: Changing modify acls to: root
2022-01-26 14:43:22,361 INFO spark.SecurityManager: Changing view acls groups to: 
2022-01-26 14:43:22,361 INFO spark.SecurityManager: Changing modify acls groups to: 
2022-01-26 14:43:22,361 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()
2022-01-26 14:43:22,733 INFO util.Utils: Successfully started service 'sparkDriver' on port 7001.
2022-01-26 14:43:22,824 INFO spark.SparkEnv: Registering MapOutputTracker
2022-01-26 14:43:22,844 INFO spark.SparkEnv: Registering BlockManagerMaster
2022-01-26 14:43:22,851 INFO storage.BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2022-01-26 14:43:22,852 INFO storage.BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
2022-01-26 14:43:22,859 INFO storage.DiskBlockManager: Created local directory at /tmp/blockmgr-e8445a20-c831-488d-8efc-b4ae6b9e60cf
2022-01-26 14:43:22,890 INFO memory.MemoryStore: MemoryStore started with capacity 7.8 GB
2022-01-26 14:43:22,932 INFO spark.SparkEnv: Registering OutputCommitCoordinator
2022-01-26 14:43:23,064 INFO util.log: Logging initialized @5255ms
2022-01-26 14:43:23,172 INFO server.Server: jetty-9.3.z-SNAPSHOT, build timestamp: unknown, git hash: unknown
2022-01-26 14:43:23,297 INFO server.Server: Started @5490ms
2022-01-26 14:43:23,319 INFO server.AbstractConnector: Started ServerConnector@6f099757{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2022-01-26 14:43:23,331 INFO util.Utils: Successfully started service 'SparkUI' on port 4040.
2022-01-26 14:43:23,381 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@5c176b3{/jobs,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,381 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@2fd2e2f2{/jobs/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,382 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@1162753c{/jobs/job,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,383 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@1a0b5b91{/jobs/job/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,384 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@22f6ff50{/stages,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,384 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@203fb5a7{/stages/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,384 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@342d68c9{/stages/stage,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,386 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@3cec04a8{/stages/stage/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,386 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@63d858dc{/stages/pool,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,387 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@449534b3{/stages/pool/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,387 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@3d7205b0{/storage,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,388 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@61678ff2{/storage/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,388 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@405835ba{/storage/rdd,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,389 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@2d05b1ae{/storage/rdd/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,389 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@f77e3b{/environment,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,391 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@5d3279c8{/environment/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,392 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@5cc67231{/executors,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,392 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@5cce20c6{/executors/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,393 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@67738bc2{/executors/threadDump,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,414 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@29c152dd{/executors/threadDump/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,431 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@4679ea2e{/static,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,432 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@103d8978{/,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,433 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@45f1dcc6{/api,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,433 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@64328b46{/jobs/job/kill,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,434 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@1e258efe{/stages/stage/kill,null,AVAILABLE,@Spark}
2022-01-26 14:43:23,451 INFO ui.SparkUI: Bound SparkUI to 0.0.0.0, and started at http://localhost:4040
2022-01-26 14:43:23,464 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar at spark://master:7001/jars/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar with timestamp 1643208203463
2022-01-26 14:43:23,464 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-utils-1.0.0.jar at spark://master:7001/jars/com.github.jelmerk_hnswlib-utils-1.0.0.jar with timestamp 1643208203464
2022-01-26 14:43:23,464 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar at spark://master:7001/jars/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar with timestamp 1643208203464
2022-01-26 14:43:23,464 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-core-1.0.0.jar at spark://master:7001/jars/com.github.jelmerk_hnswlib-core-1.0.0.jar with timestamp 1643208203464
2022-01-26 14:43:23,465 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at spark://master:7001/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1643208203464
2022-01-26 14:43:23,465 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at spark://master:7001/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1643208203465
2022-01-26 14:43:23,477 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar at spark://master:7001/files/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar with timestamp 1643208203477
2022-01-26 14:43:23,478 INFO util.Utils: Copying /root/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar to /tmp/spark-f7e8f96e-e2fb-4b33-aa80-8d0d998ee93e/userFiles-526cc6c5-6c9b-4edc-a07e-a34193c8c6ed/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar
2022-01-26 14:43:23,825 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-utils-1.0.0.jar at spark://master:7001/files/com.github.jelmerk_hnswlib-utils-1.0.0.jar with timestamp 1643208203825
2022-01-26 14:43:23,825 INFO util.Utils: Copying /root/.ivy2/jars/com.github.jelmerk_hnswlib-utils-1.0.0.jar to /tmp/spark-f7e8f96e-e2fb-4b33-aa80-8d0d998ee93e/userFiles-526cc6c5-6c9b-4edc-a07e-a34193c8c6ed/com.github.jelmerk_hnswlib-utils-1.0.0.jar
2022-01-26 14:43:23,835 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar at spark://master:7001/files/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar with timestamp 1643208203834
2022-01-26 14:43:23,835 INFO util.Utils: Copying /root/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar to /tmp/spark-f7e8f96e-e2fb-4b33-aa80-8d0d998ee93e/userFiles-526cc6c5-6c9b-4edc-a07e-a34193c8c6ed/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar
2022-01-26 14:43:23,839 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-core-1.0.0.jar at spark://master:7001/files/com.github.jelmerk_hnswlib-core-1.0.0.jar with timestamp 1643208203839
2022-01-26 14:43:23,839 INFO util.Utils: Copying /root/.ivy2/jars/com.github.jelmerk_hnswlib-core-1.0.0.jar to /tmp/spark-f7e8f96e-e2fb-4b33-aa80-8d0d998ee93e/userFiles-526cc6c5-6c9b-4edc-a07e-a34193c8c6ed/com.github.jelmerk_hnswlib-core-1.0.0.jar
2022-01-26 14:43:23,855 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at spark://master:7001/files/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1643208203855
2022-01-26 14:43:23,855 INFO util.Utils: Copying /root/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar to /tmp/spark-f7e8f96e-e2fb-4b33-aa80-8d0d998ee93e/userFiles-526cc6c5-6c9b-4edc-a07e-a34193c8c6ed/org.eclipse.collections_eclipse-collections-9.2.0.jar
2022-01-26 14:43:23,895 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at spark://master:7001/files/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1643208203895
2022-01-26 14:43:23,895 INFO util.Utils: Copying /root/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to /tmp/spark-f7e8f96e-e2fb-4b33-aa80-8d0d998ee93e/userFiles-526cc6c5-6c9b-4edc-a07e-a34193c8c6ed/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2022-01-26 14:43:24,026 INFO client.StandaloneAppClient$ClientEndpoint: Connecting to master spark://master:7077...
2022-01-26 14:43:24,173 INFO client.TransportClientFactory: Successfully created connection to master/172.18.0.2:7077 after 129 ms (0 ms spent in bootstraps)
2022-01-26 14:43:24,256 INFO cluster.StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20220126144324-0013
2022-01-26 14:43:24,262 INFO client.StandaloneAppClient$ClientEndpoint: Executor added: app-20220126144324-0013/0 on worker-20220126084746-172.18.0.3-18881 (172.18.0.3:18881) with 2 core(s)
2022-01-26 14:43:24,278 INFO cluster.StandaloneSchedulerBackend: Granted executor ID app-20220126144324-0013/0 on hostPort 172.18.0.3:18881 with 2 core(s), 3.0 GB RAM
2022-01-26 14:43:24,279 INFO client.StandaloneAppClient$ClientEndpoint: Executor added: app-20220126144324-0013/1 on worker-20220126084746-172.18.0.3-18881 (172.18.0.3:18881) with 2 core(s)
2022-01-26 14:43:24,279 INFO cluster.StandaloneSchedulerBackend: Granted executor ID app-20220126144324-0013/1 on hostPort 172.18.0.3:18881 with 2 core(s), 3.0 GB RAM
2022-01-26 14:43:24,279 INFO client.StandaloneAppClient$ClientEndpoint: Executor added: app-20220126144324-0013/2 on worker-20220126084746-172.18.0.3-18881 (172.18.0.3:18881) with 2 core(s)
2022-01-26 14:43:24,280 INFO cluster.StandaloneSchedulerBackend: Granted executor ID app-20220126144324-0013/2 on hostPort 172.18.0.3:18881 with 2 core(s), 3.0 GB RAM
2022-01-26 14:43:24,280 INFO util.Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 7005.
2022-01-26 14:43:24,280 INFO netty.NettyBlockTransferService: Server created on master:7005
2022-01-26 14:43:24,281 INFO storage.BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2022-01-26 14:43:24,284 INFO client.StandaloneAppClient$ClientEndpoint: Executor updated: app-20220126144324-0013/0 is now RUNNING
2022-01-26 14:43:24,286 INFO client.StandaloneAppClient$ClientEndpoint: Executor updated: app-20220126144324-0013/1 is now RUNNING
2022-01-26 14:43:24,288 INFO client.StandaloneAppClient$ClientEndpoint: Executor updated: app-20220126144324-0013/2 is now RUNNING
2022-01-26 14:43:24,301 INFO storage.BlockManagerMaster: Registering BlockManager BlockManagerId(driver, master, 7005, None)
2022-01-26 14:43:24,305 INFO storage.BlockManagerMasterEndpoint: Registering block manager master:7005 with 7.8 GB RAM, BlockManagerId(driver, master, 7005, None)
2022-01-26 14:43:24,308 INFO storage.BlockManagerMaster: Registered BlockManager BlockManagerId(driver, master, 7005, None)
2022-01-26 14:43:24,309 INFO storage.BlockManager: Initialized BlockManager: BlockManagerId(driver, master, 7005, None)
2022-01-26 14:43:24,320 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@2b157788{/metrics/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:24,359 INFO cluster.StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
2022-01-26 14:43:24,508 WARN spark.SparkContext: Spark is not running in local mode, therefore the checkpoint directory must not be on the local filesystem. Directory '/tmp' appears to be on the local filesystem.
2022-01-26 14:43:27,118 INFO cluster.CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.18.0.3:36630) with ID 0
2022-01-26 14:43:27,253 INFO storage.BlockManagerMasterEndpoint: Registering block manager 172.18.0.3:7005 with 1458.6 MB RAM, BlockManagerId(0, 172.18.0.3, 7005, None)
2022-01-26 14:43:27,334 INFO cluster.CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.18.0.3:36636) with ID 1
2022-01-26 14:43:27,468 INFO cluster.CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.18.0.3:36638) with ID 2
2022-01-26 14:43:27,469 INFO storage.BlockManagerMasterEndpoint: Registering block manager 172.18.0.3:7006 with 1458.6 MB RAM, BlockManagerId(1, 172.18.0.3, 7006, None)
2022-01-26 14:43:27,623 INFO storage.BlockManagerMasterEndpoint: Registering block manager 172.18.0.3:7007 with 1458.6 MB RAM, BlockManagerId(2, 172.18.0.3, 7007, None)
2022-01-26 14:43:42,473 INFO internal.SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/aknn/spark-warehouse').
2022-01-26 14:43:42,474 INFO internal.SharedState: Warehouse path is 'file:/aknn/spark-warehouse'.
2022-01-26 14:43:42,481 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@6474ad78{/SQL,null,AVAILABLE,@Spark}
2022-01-26 14:43:42,481 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@3794826a{/SQL/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:42,481 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@36b15795{/SQL/execution,null,AVAILABLE,@Spark}
2022-01-26 14:43:42,482 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@20a3b7a2{/SQL/execution/json,null,AVAILABLE,@Spark}
2022-01-26 14:43:42,485 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@37e8cf6f{/static/sql,null,AVAILABLE,@Spark}
2022-01-26 14:43:42,848 INFO state.StateStoreCoordinatorRef: Registered StateStoreCoordinator endpoint
2022-01-26 14:45:11,678 INFO spark.SparkContext: Invoking stop() from shutdown hook
2022-01-26 14:45:11,685 INFO server.AbstractConnector: Stopped Spark@6f099757{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2022-01-26 14:45:11,687 INFO ui.SparkUI: Stopped Spark web UI at http://localhost:4040
2022-01-26 14:45:11,691 INFO cluster.StandaloneSchedulerBackend: Shutting down all executors
2022-01-26 14:45:11,691 INFO cluster.CoarseGrainedSchedulerBackend$DriverEndpoint: Asking each executor to shut down
2022-01-26 14:45:11,761 INFO spark.MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
2022-01-26 14:45:11,838 INFO memory.MemoryStore: MemoryStore cleared
2022-01-26 14:45:11,838 INFO storage.BlockManager: BlockManager stopped
2022-01-26 14:45:11,839 INFO storage.BlockManagerMaster: BlockManagerMaster stopped
2022-01-26 14:45:11,840 INFO scheduler.OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
2022-01-26 14:45:11,882 INFO spark.SparkContext: Successfully stopped SparkContext
2022-01-26 14:45:11,882 INFO util.ShutdownHookManager: Shutdown hook called
2022-01-26 14:45:11,883 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-f7e8f96e-e2fb-4b33-aa80-8d0d998ee93e
2022-01-26 14:45:11,891 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-1cb62db7-95b6-46a9-b8ec-d0eae1cea54c
2022-01-26 14:45:11,899 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-f7e8f96e-e2fb-4b33-aa80-8d0d998ee93e/pyspark-e47aaa8a-8616-46aa-827d-f7ab03cbc3fd
/aknn
com.github.jelmerk:hnswlib-spark_2.4_2.11:1.0.0
