nohup: ignoring input
/aknn/alllog/1/1/33.log
Ivy Default Cache set to: /root/.ivy2/cache
The jars for the packages stored in: /root/.ivy2/jars
:: loading settings :: url = jar:file:/usr/spark-2.4.1/jars/ivy-2.4.0.jar!/org/apache/ivy/core/settings/ivysettings.xml
com.github.jelmerk#hnswlib-spark_2.4_2.11 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-809640d8-edfa-4c36-b51d-07c935860b44;1.0
	confs: [default]
	found com.github.jelmerk#hnswlib-spark_2.4_2.11;1.0.0 in central
	found com.github.jelmerk#hnswlib-utils;1.0.0 in central
	found com.github.jelmerk#hnswlib-scala_2.11;1.0.0 in central
	found com.github.jelmerk#hnswlib-core;1.0.0 in central
	found org.eclipse.collections#eclipse-collections;9.2.0 in central
	found org.eclipse.collections#eclipse-collections-api;9.2.0 in central
:: resolution report :: resolve 234ms :: artifacts dl 7ms
	:: modules in use:
	com.github.jelmerk#hnswlib-core;1.0.0 from central in [default]
	com.github.jelmerk#hnswlib-scala_2.11;1.0.0 from central in [default]
	com.github.jelmerk#hnswlib-spark_2.4_2.11;1.0.0 from central in [default]
	com.github.jelmerk#hnswlib-utils;1.0.0 from central in [default]
	org.eclipse.collections#eclipse-collections;9.2.0 from central in [default]
	org.eclipse.collections#eclipse-collections-api;9.2.0 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   6   |   0   |   0   |   0   ||   6   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-809640d8-edfa-4c36-b51d-07c935860b44
	confs: [default]
	0 artifacts copied, 6 already retrieved (0kB/6ms)
2022-01-26 12:24:02,989 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2022-01-26 12:24:04,686 INFO spark.SparkContext: Running Spark version 2.4.1
2022-01-26 12:24:04,704 INFO spark.SparkContext: Submitted application: mytest
2022-01-26 12:24:04,737 INFO spark.SecurityManager: Changing view acls to: root
2022-01-26 12:24:04,737 INFO spark.SecurityManager: Changing modify acls to: root
2022-01-26 12:24:04,737 INFO spark.SecurityManager: Changing view acls groups to: 
2022-01-26 12:24:04,737 INFO spark.SecurityManager: Changing modify acls groups to: 
2022-01-26 12:24:04,737 INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()
2022-01-26 12:24:04,906 INFO util.Utils: Successfully started service 'sparkDriver' on port 7001.
2022-01-26 12:24:04,954 INFO spark.SparkEnv: Registering MapOutputTracker
2022-01-26 12:24:04,966 INFO spark.SparkEnv: Registering BlockManagerMaster
2022-01-26 12:24:04,968 INFO storage.BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2022-01-26 12:24:04,969 INFO storage.BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
2022-01-26 12:24:04,975 INFO storage.DiskBlockManager: Created local directory at /tmp/blockmgr-1de8d292-49a9-48b0-8d8b-fe353911c193
2022-01-26 12:24:04,986 INFO memory.MemoryStore: MemoryStore started with capacity 7.8 GB
2022-01-26 12:24:05,012 INFO spark.SparkEnv: Registering OutputCommitCoordinator
2022-01-26 12:24:05,072 INFO util.log: Logging initialized @3489ms
2022-01-26 12:24:05,122 INFO server.Server: jetty-9.3.z-SNAPSHOT, build timestamp: unknown, git hash: unknown
2022-01-26 12:24:05,147 INFO server.Server: Started @3564ms
2022-01-26 12:24:05,160 INFO server.AbstractConnector: Started ServerConnector@1acf6eff{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2022-01-26 12:24:05,160 INFO util.Utils: Successfully started service 'SparkUI' on port 4040.
2022-01-26 12:24:05,215 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@7217265e{/jobs,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,215 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@a35e3ef{/jobs/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,216 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@27a6982c{/jobs/job,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,216 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@1274e1a4{/jobs/job/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,217 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@377b529e{/stages,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,217 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@248fcba5{/stages/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,217 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@75508650{/stages/stage,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,218 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@77964145{/stages/stage/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,219 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@6852be1{/stages/pool,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,219 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@27bc6b76{/stages/pool/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,219 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@795129d4{/storage,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,220 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@3c08c3d2{/storage/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,220 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@13fd3d91{/storage/rdd,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,220 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@575e0343{/storage/rdd/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,221 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@27319ff5{/environment,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,221 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@5d5dde92{/environment/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,221 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@27b6711d{/executors,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,222 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@553ab3{/executors/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,222 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@2b30c37b{/executors/threadDump,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,222 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@182a31c1{/executors/threadDump/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,227 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@c009540{/static,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,227 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@51eda09b{/,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,228 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@6d5f7ef2{/api,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,229 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@4c7eaad9{/jobs/job/kill,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,229 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@2327743c{/stages/stage/kill,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,230 INFO ui.SparkUI: Bound SparkUI to 0.0.0.0, and started at http://localhost:4040
2022-01-26 12:24:05,242 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar at spark://master:7001/jars/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar with timestamp 1643199845241
2022-01-26 12:24:05,242 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-utils-1.0.0.jar at spark://master:7001/jars/com.github.jelmerk_hnswlib-utils-1.0.0.jar with timestamp 1643199845242
2022-01-26 12:24:05,242 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar at spark://master:7001/jars/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar with timestamp 1643199845242
2022-01-26 12:24:05,242 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-core-1.0.0.jar at spark://master:7001/jars/com.github.jelmerk_hnswlib-core-1.0.0.jar with timestamp 1643199845242
2022-01-26 12:24:05,242 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at spark://master:7001/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1643199845242
2022-01-26 12:24:05,242 INFO spark.SparkContext: Added JAR file:///root/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at spark://master:7001/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1643199845242
2022-01-26 12:24:05,256 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar at spark://master:7001/files/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar with timestamp 1643199845255
2022-01-26 12:24:05,257 INFO util.Utils: Copying /root/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar to /tmp/spark-a3b06c23-cf2a-4e91-bce9-88829888dec4/userFiles-306c0c0a-c744-40c1-b1ec-9cc1e49f5eca/com.github.jelmerk_hnswlib-spark_2.4_2.11-1.0.0.jar
2022-01-26 12:24:05,487 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-utils-1.0.0.jar at spark://master:7001/files/com.github.jelmerk_hnswlib-utils-1.0.0.jar with timestamp 1643199845487
2022-01-26 12:24:05,487 INFO util.Utils: Copying /root/.ivy2/jars/com.github.jelmerk_hnswlib-utils-1.0.0.jar to /tmp/spark-a3b06c23-cf2a-4e91-bce9-88829888dec4/userFiles-306c0c0a-c744-40c1-b1ec-9cc1e49f5eca/com.github.jelmerk_hnswlib-utils-1.0.0.jar
2022-01-26 12:24:05,489 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar at spark://master:7001/files/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar with timestamp 1643199845489
2022-01-26 12:24:05,490 INFO util.Utils: Copying /root/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar to /tmp/spark-a3b06c23-cf2a-4e91-bce9-88829888dec4/userFiles-306c0c0a-c744-40c1-b1ec-9cc1e49f5eca/com.github.jelmerk_hnswlib-scala_2.11-1.0.0.jar
2022-01-26 12:24:05,492 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/com.github.jelmerk_hnswlib-core-1.0.0.jar at spark://master:7001/files/com.github.jelmerk_hnswlib-core-1.0.0.jar with timestamp 1643199845492
2022-01-26 12:24:05,492 INFO util.Utils: Copying /root/.ivy2/jars/com.github.jelmerk_hnswlib-core-1.0.0.jar to /tmp/spark-a3b06c23-cf2a-4e91-bce9-88829888dec4/userFiles-306c0c0a-c744-40c1-b1ec-9cc1e49f5eca/com.github.jelmerk_hnswlib-core-1.0.0.jar
2022-01-26 12:24:05,513 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at spark://master:7001/files/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1643199845513
2022-01-26 12:24:05,513 INFO util.Utils: Copying /root/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar to /tmp/spark-a3b06c23-cf2a-4e91-bce9-88829888dec4/userFiles-306c0c0a-c744-40c1-b1ec-9cc1e49f5eca/org.eclipse.collections_eclipse-collections-9.2.0.jar
2022-01-26 12:24:05,532 INFO spark.SparkContext: Added file file:///root/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at spark://master:7001/files/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1643199845532
2022-01-26 12:24:05,532 INFO util.Utils: Copying /root/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to /tmp/spark-a3b06c23-cf2a-4e91-bce9-88829888dec4/userFiles-306c0c0a-c744-40c1-b1ec-9cc1e49f5eca/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2022-01-26 12:24:05,585 INFO client.StandaloneAppClient$ClientEndpoint: Connecting to master spark://master:7077...
2022-01-26 12:24:05,667 INFO client.TransportClientFactory: Successfully created connection to master/172.18.0.2:7077 after 71 ms (0 ms spent in bootstraps)
2022-01-26 12:24:05,725 INFO cluster.StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20220126122405-0007
2022-01-26 12:24:05,731 INFO client.StandaloneAppClient$ClientEndpoint: Executor added: app-20220126122405-0007/0 on worker-20220126084746-172.18.0.3-18881 (172.18.0.3:18881) with 2 core(s)
2022-01-26 12:24:05,731 INFO cluster.StandaloneSchedulerBackend: Granted executor ID app-20220126122405-0007/0 on hostPort 172.18.0.3:18881 with 2 core(s), 3.0 GB RAM
2022-01-26 12:24:05,750 INFO client.StandaloneAppClient$ClientEndpoint: Executor added: app-20220126122405-0007/1 on worker-20220126084746-172.18.0.3-18881 (172.18.0.3:18881) with 2 core(s)
2022-01-26 12:24:05,750 INFO cluster.StandaloneSchedulerBackend: Granted executor ID app-20220126122405-0007/1 on hostPort 172.18.0.3:18881 with 2 core(s), 3.0 GB RAM
2022-01-26 12:24:05,750 INFO client.StandaloneAppClient$ClientEndpoint: Executor added: app-20220126122405-0007/2 on worker-20220126084746-172.18.0.3-18881 (172.18.0.3:18881) with 2 core(s)
2022-01-26 12:24:05,750 INFO cluster.StandaloneSchedulerBackend: Granted executor ID app-20220126122405-0007/2 on hostPort 172.18.0.3:18881 with 2 core(s), 3.0 GB RAM
2022-01-26 12:24:05,752 INFO util.Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 7005.
2022-01-26 12:24:05,752 INFO netty.NettyBlockTransferService: Server created on master:7005
2022-01-26 12:24:05,753 INFO storage.BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2022-01-26 12:24:05,769 INFO storage.BlockManagerMaster: Registering BlockManager BlockManagerId(driver, master, 7005, None)
2022-01-26 12:24:05,770 INFO storage.BlockManagerMasterEndpoint: Registering block manager master:7005 with 7.8 GB RAM, BlockManagerId(driver, master, 7005, None)
2022-01-26 12:24:05,778 INFO storage.BlockManagerMaster: Registered BlockManager BlockManagerId(driver, master, 7005, None)
2022-01-26 12:24:05,778 INFO storage.BlockManager: Initialized BlockManager: BlockManagerId(driver, master, 7005, None)
2022-01-26 12:24:05,782 INFO client.StandaloneAppClient$ClientEndpoint: Executor updated: app-20220126122405-0007/0 is now RUNNING
2022-01-26 12:24:05,783 INFO client.StandaloneAppClient$ClientEndpoint: Executor updated: app-20220126122405-0007/1 is now RUNNING
2022-01-26 12:24:05,783 INFO client.StandaloneAppClient$ClientEndpoint: Executor updated: app-20220126122405-0007/2 is now RUNNING
2022-01-26 12:24:05,797 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@122190b8{/metrics/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:05,821 INFO cluster.StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
2022-01-26 12:24:05,900 WARN spark.SparkContext: Spark is not running in local mode, therefore the checkpoint directory must not be on the local filesystem. Directory '/tmp' appears to be on the local filesystem.
2022-01-26 12:24:08,196 INFO cluster.CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.18.0.3:35620) with ID 1
2022-01-26 12:24:08,229 INFO cluster.CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.18.0.3:35622) with ID 0
2022-01-26 12:24:08,313 INFO storage.BlockManagerMasterEndpoint: Registering block manager 172.18.0.3:7005 with 1458.6 MB RAM, BlockManagerId(1, 172.18.0.3, 7005, None)
2022-01-26 12:24:08,371 INFO storage.BlockManagerMasterEndpoint: Registering block manager 172.18.0.3:7006 with 1458.6 MB RAM, BlockManagerId(0, 172.18.0.3, 7006, None)
2022-01-26 12:24:08,483 INFO cluster.CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.18.0.3:35626) with ID 2
2022-01-26 12:24:08,571 INFO storage.BlockManagerMasterEndpoint: Registering block manager 172.18.0.3:7007 with 1458.6 MB RAM, BlockManagerId(2, 172.18.0.3, 7007, None)
2022-01-26 12:24:20,438 INFO internal.SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/aknn/spark-warehouse').
2022-01-26 12:24:20,438 INFO internal.SharedState: Warehouse path is 'file:/aknn/spark-warehouse'.
2022-01-26 12:24:20,444 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@7050485a{/SQL,null,AVAILABLE,@Spark}
2022-01-26 12:24:20,444 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@6d7fa22d{/SQL/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:20,445 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@254fd0e6{/SQL/execution,null,AVAILABLE,@Spark}
2022-01-26 12:24:20,445 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@64e7759b{/SQL/execution/json,null,AVAILABLE,@Spark}
2022-01-26 12:24:20,446 INFO handler.ContextHandler: Started o.s.j.s.ServletContextHandler@6fc466c8{/static/sql,null,AVAILABLE,@Spark}
2022-01-26 12:24:20,697 INFO state.StateStoreCoordinatorRef: Registered StateStoreCoordinator endpoint
2022-01-26 12:25:43,567 INFO spark.SparkContext: Invoking stop() from shutdown hook
2022-01-26 12:25:43,571 INFO server.AbstractConnector: Stopped Spark@1acf6eff{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2022-01-26 12:25:43,572 INFO ui.SparkUI: Stopped Spark web UI at http://localhost:4040
2022-01-26 12:25:43,575 INFO cluster.StandaloneSchedulerBackend: Shutting down all executors
2022-01-26 12:25:43,575 INFO cluster.CoarseGrainedSchedulerBackend$DriverEndpoint: Asking each executor to shut down
2022-01-26 12:25:43,610 INFO spark.MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
2022-01-26 12:25:43,724 INFO memory.MemoryStore: MemoryStore cleared
2022-01-26 12:25:43,724 INFO storage.BlockManager: BlockManager stopped
2022-01-26 12:25:43,725 INFO storage.BlockManagerMaster: BlockManagerMaster stopped
2022-01-26 12:25:43,728 INFO scheduler.OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
2022-01-26 12:25:43,755 INFO spark.SparkContext: Successfully stopped SparkContext
2022-01-26 12:25:43,755 INFO util.ShutdownHookManager: Shutdown hook called
2022-01-26 12:25:43,755 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-a3b06c23-cf2a-4e91-bce9-88829888dec4
2022-01-26 12:25:43,759 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-a3b06c23-cf2a-4e91-bce9-88829888dec4/pyspark-0f9c8d7f-18cd-447f-b30f-429c1a6a2aa6
2022-01-26 12:25:43,767 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-a8984fd4-83fc-4313-aab8-9849530a1cb7
/aknn
com.github.jelmerk:hnswlib-spark_2.4_2.11:1.0.0
