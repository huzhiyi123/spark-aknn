2021-11-30 19:58:15 WARN  Utils:66 - Your hostname, LAPTOP-K1RS47MN resolves to a loopback address: 127.0.1.1; using 10.162.40.121 instead (on interface wifi0)
2021-11-30 19:58:15 WARN  Utils:66 - Set SPARK_LOCAL_IP if you need to bind to another address
2021-11-30 19:58:16 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2021-11-30 19:58:17 INFO  SparkContext:54 - Running Spark version 2.3.0
2021-11-30 19:58:17 INFO  SparkContext:54 - Submitted application: mytest
2021-11-30 19:58:18 INFO  SecurityManager:54 - Changing view acls to: yaoheng
2021-11-30 19:58:18 INFO  SecurityManager:54 - Changing modify acls to: yaoheng
2021-11-30 19:58:18 INFO  SecurityManager:54 - Changing view acls groups to: 
2021-11-30 19:58:18 INFO  SecurityManager:54 - Changing modify acls groups to: 
2021-11-30 19:58:18 INFO  SecurityManager:54 - SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(yaoheng); groups with view permissions: Set(); users  with modify permissions: Set(yaoheng); groups with modify permissions: Set()
2021-11-30 19:58:18 INFO  Utils:54 - Successfully started service 'sparkDriver' on port 58819.
2021-11-30 19:58:18 INFO  SparkEnv:54 - Registering MapOutputTracker
2021-11-30 19:58:18 INFO  SparkEnv:54 - Registering BlockManagerMaster
2021-11-30 19:58:18 INFO  BlockManagerMasterEndpoint:54 - Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2021-11-30 19:58:18 INFO  BlockManagerMasterEndpoint:54 - BlockManagerMasterEndpoint up
2021-11-30 19:58:18 INFO  DiskBlockManager:54 - Created local directory at /tmp/blockmgr-c55f373c-25ad-43a4-8d97-a79fd020ab60
2021-11-30 19:58:18 INFO  MemoryStore:54 - MemoryStore started with capacity 2.5 GB
2021-11-30 19:58:18 INFO  SparkEnv:54 - Registering OutputCommitCoordinator
2021-11-30 19:58:18 INFO  log:192 - Logging initialized @3985ms
2021-11-30 19:58:18 INFO  Server:346 - jetty-9.3.z-SNAPSHOT
2021-11-30 19:58:18 INFO  Server:414 - Started @4067ms
2021-11-30 19:58:18 INFO  AbstractConnector:278 - Started ServerConnector@12d8416c{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2021-11-30 19:58:18 INFO  Utils:54 - Successfully started service 'SparkUI' on port 4040.
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6fd1b2aa{/jobs,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@55c54845{/jobs/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@e3ce9f2{/jobs/job,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7cd80227{/jobs/job/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@320fa99{/stages,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6abae076{/stages/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@728070bd{/stages/stage,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7701b2f3{/stages/stage/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6752136{/stages/pool,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@648d3605{/stages/pool/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@47cd1eb{/storage,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7e906dbd{/storage/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@51438fc8{/storage/rdd,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5cf3b6fb{/storage/rdd/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3ee2c707{/environment,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@43e2a8e3{/environment/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@e125298{/executors,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4f9769cf{/executors/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@67e545c5{/executors/threadDump,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@31164c6a{/executors/threadDump/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2d8c4e42{/static,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@65ee387e{/,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@f19ae9a{/api,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@46732ced{/jobs/job/kill,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@b5884bd{/stages/stage/kill,null,AVAILABLE,@Spark}
2021-11-30 19:58:18 INFO  SparkUI:54 - Bound SparkUI to 0.0.0.0, and started at http://10.162.40.121:4040
2021-11-30 19:58:18 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar at spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638273498722
2021-11-30 19:58:18 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar at spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638273498723
2021-11-30 19:58:18 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar at spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638273498723
2021-11-30 19:58:18 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar at spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638273498723
2021-11-30 19:58:18 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at spark://10.162.40.121:58819/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638273498723
2021-11-30 19:58:18 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at spark://10.162.40.121:58819/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638273498724
2021-11-30 19:58:18 INFO  SparkContext:54 - Added file file:/home/yaoheng/test/spark-aknn/test/test.py at file:/home/yaoheng/test/spark-aknn/test/test.py with timestamp 1638273498725
2021-11-30 19:58:18 INFO  Utils:54 - Copying /home/yaoheng/test/spark-aknn/test/test.py to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/test.py
2021-11-30 19:58:18 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638273498748
2021-11-30 19:58:18 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 19:58:18 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638273498761
2021-11-30 19:58:18 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 19:58:18 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638273498772
2021-11-30 19:58:18 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 19:58:18 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638273498785
2021-11-30 19:58:18 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 19:58:18 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638273498797
2021-11-30 19:58:18 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 19:58:18 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638273498836
2021-11-30 19:58:18 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 19:58:18 INFO  Executor:54 - Starting executor ID driver on host localhost
2021-11-30 19:58:18 INFO  Utils:54 - Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 58825.
2021-11-30 19:58:18 INFO  NettyBlockTransferService:54 - Server created on 10.162.40.121:58825
2021-11-30 19:58:18 INFO  BlockManager:54 - Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2021-11-30 19:58:18 INFO  BlockManagerMaster:54 - Registering BlockManager BlockManagerId(driver, 10.162.40.121, 58825, None)
2021-11-30 19:58:18 INFO  BlockManagerMasterEndpoint:54 - Registering block manager 10.162.40.121:58825 with 2.5 GB RAM, BlockManagerId(driver, 10.162.40.121, 58825, None)
2021-11-30 19:58:18 INFO  BlockManagerMaster:54 - Registered BlockManager BlockManagerId(driver, 10.162.40.121, 58825, None)
2021-11-30 19:58:18 INFO  BlockManager:54 - Initialized BlockManager: BlockManagerId(driver, 10.162.40.121, 58825, None)
2021-11-30 19:58:19 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4bedc4aa{/metrics/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:19 INFO  SharedState:54 - Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/home/yaoheng/test/spark-aknn/spark-warehouse/').
2021-11-30 19:58:19 INFO  SharedState:54 - Warehouse path is 'file:/home/yaoheng/test/spark-aknn/spark-warehouse/'.
2021-11-30 19:58:19 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@30f39f44{/SQL,null,AVAILABLE,@Spark}
2021-11-30 19:58:19 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@507e6e5b{/SQL/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:19 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@35d4ac0c{/SQL/execution,null,AVAILABLE,@Spark}
2021-11-30 19:58:19 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@948a206{/SQL/execution/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:19 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3a6dfefa{/static/sql,null,AVAILABLE,@Spark}
2021-11-30 19:58:19 INFO  StateStoreCoordinatorRef:54 - Registered StateStoreCoordinator endpoint
2021-11-30 19:58:23 INFO  CodeGenerator:54 - Code generated in 199.6567 ms
2021-11-30 19:58:23 INFO  SparkContext:54 - Starting job: foreachPartition at KnnAlgorithm.scala:846
2021-11-30 19:58:23 INFO  DAGScheduler:54 - Registering RDD 12 (foreachPartition at KnnAlgorithm.scala:846)
2021-11-30 19:58:23 INFO  DAGScheduler:54 - Got job 0 (foreachPartition at KnnAlgorithm.scala:846) with 4 output partitions
2021-11-30 19:58:23 INFO  DAGScheduler:54 - Final stage: ResultStage 1 (foreachPartition at KnnAlgorithm.scala:846)
2021-11-30 19:58:23 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 0)
2021-11-30 19:58:23 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 0)
2021-11-30 19:58:23 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 0 (MapPartitionsRDD[12] at foreachPartition at KnnAlgorithm.scala:846), which has no missing parents
2021-11-30 19:58:23 INFO  MemoryStore:54 - Block broadcast_0 stored as values in memory (estimated size 14.1 KB, free 2.5 GB)
2021-11-30 19:58:23 INFO  MemoryStore:54 - Block broadcast_0_piece0 stored as bytes in memory (estimated size 7.2 KB, free 2.5 GB)
2021-11-30 19:58:23 INFO  BlockManagerInfo:54 - Added broadcast_0_piece0 in memory on 10.162.40.121:58825 (size: 7.2 KB, free: 2.5 GB)
2021-11-30 19:58:23 INFO  SparkContext:54 - Created broadcast 0 from broadcast at DAGScheduler.scala:1039
2021-11-30 19:58:23 INFO  DAGScheduler:54 - Submitting 4 missing tasks from ShuffleMapStage 0 (MapPartitionsRDD[12] at foreachPartition at KnnAlgorithm.scala:846) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
2021-11-30 19:58:23 INFO  TaskSchedulerImpl:54 - Adding task set 0.0 with 4 tasks
2021-11-30 19:58:23 WARN  TaskSetManager:66 - Stage 0 contains a task of very large size (2343 KB). The maximum recommended task size is 100 KB.
2021-11-30 19:58:23 INFO  TaskSetManager:54 - Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, PROCESS_LOCAL, 2400194 bytes)
2021-11-30 19:58:23 INFO  TaskSetManager:54 - Starting task 1.0 in stage 0.0 (TID 1, localhost, executor driver, partition 1, PROCESS_LOCAL, 3596761 bytes)
2021-11-30 19:58:23 INFO  TaskSetManager:54 - Starting task 2.0 in stage 0.0 (TID 2, localhost, executor driver, partition 2, PROCESS_LOCAL, 2400450 bytes)
2021-11-30 19:58:23 INFO  TaskSetManager:54 - Starting task 3.0 in stage 0.0 (TID 3, localhost, executor driver, partition 3, PROCESS_LOCAL, 3316199 bytes)
2021-11-30 19:58:23 INFO  Executor:54 - Running task 3.0 in stage 0.0 (TID 3)
2021-11-30 19:58:23 INFO  Executor:54 - Running task 0.0 in stage 0.0 (TID 0)
2021-11-30 19:58:23 INFO  Executor:54 - Running task 2.0 in stage 0.0 (TID 2)
2021-11-30 19:58:23 INFO  Executor:54 - Running task 1.0 in stage 0.0 (TID 1)
2021-11-30 19:58:24 INFO  Executor:54 - Fetching file:/home/yaoheng/test/spark-aknn/test/test.py with timestamp 1638273498725
2021-11-30 19:58:24 INFO  Utils:54 - /home/yaoheng/test/spark-aknn/test/test.py has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/test.py
2021-11-30 19:58:24 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638273498797
2021-11-30 19:58:24 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 19:58:24 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638273498748
2021-11-30 19:58:24 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 19:58:24 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638273498772
2021-11-30 19:58:24 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 19:58:24 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638273498785
2021-11-30 19:58:24 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 19:58:24 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638273498761
2021-11-30 19:58:24 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 19:58:24 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638273498836
2021-11-30 19:58:24 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 19:58:24 INFO  Executor:54 - Fetching spark://10.162.40.121:58819/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638273498723
2021-11-30 19:58:24 INFO  TransportClientFactory:267 - Successfully created connection to /10.162.40.121:58819 after 44 ms (0 ms spent in bootstraps)
2021-11-30 19:58:24 INFO  Utils:54 - Fetching spark://10.162.40.121:58819/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp2109784255560881290.tmp
2021-11-30 19:58:24 INFO  ContextCleaner:54 - Cleaned accumulator 1
2021-11-30 19:58:24 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp2109784255560881290.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 19:58:24 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/org.eclipse.collections_eclipse-collections-9.2.0.jar to class loader
2021-11-30 19:58:24 INFO  Executor:54 - Fetching spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638273498723
2021-11-30 19:58:24 INFO  Utils:54 - Fetching spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp6772508055393397079.tmp
2021-11-30 19:58:24 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp6772508055393397079.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 19:58:24 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to class loader
2021-11-30 19:58:24 INFO  Executor:54 - Fetching spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638273498722
2021-11-30 19:58:24 INFO  Utils:54 - Fetching spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp5283442871291593121.tmp
2021-11-30 19:58:24 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp5283442871291593121.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 19:58:24 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to class loader
2021-11-30 19:58:24 INFO  Executor:54 - Fetching spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638273498723
2021-11-30 19:58:24 INFO  Utils:54 - Fetching spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp4362981214856716520.tmp
2021-11-30 19:58:24 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp4362981214856716520.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 19:58:24 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-utils-0.0.49.jar to class loader
2021-11-30 19:58:24 INFO  Executor:54 - Fetching spark://10.162.40.121:58819/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638273498724
2021-11-30 19:58:24 INFO  Utils:54 - Fetching spark://10.162.40.121:58819/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp5593086198946396887.tmp
2021-11-30 19:58:24 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp5593086198946396887.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 19:58:24 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to class loader
2021-11-30 19:58:24 INFO  Executor:54 - Fetching spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638273498723
2021-11-30 19:58:24 INFO  Utils:54 - Fetching spark://10.162.40.121:58819/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp4316434210595720634.tmp
2021-11-30 19:58:24 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/fetchFileTemp4316434210595720634.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 19:58:24 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-b949bbda-0d04-4fc7-aaf9-a9790a21cf20/com.github.jelmerk_hnswlib-core-0.0.49.jar to class loader
2021-11-30 19:58:24 INFO  CodeGenerator:54 - Code generated in 39.5762 ms
2021-11-30 19:58:24 INFO  CodeGenerator:54 - Code generated in 16.0078 ms
2021-11-30 19:58:25 INFO  PythonRunner:54 - Times: total = 446, boot = 409, init = 2, finish = 35
2021-11-30 19:58:25 INFO  PythonRunner:54 - Times: total = 435, boot = 399, init = 2, finish = 34
2021-11-30 19:58:25 INFO  PythonRunner:54 - Times: total = 443, boot = 391, init = 9, finish = 43
2021-11-30 19:58:25 INFO  PythonRunner:54 - Times: total = 556, boot = 419, init = 2, finish = 135
2021-11-30 19:58:25 INFO  Executor:54 - Finished task 2.0 in stage 0.0 (TID 2). 1961 bytes result sent to driver
2021-11-30 19:58:25 INFO  Executor:54 - Finished task 1.0 in stage 0.0 (TID 1). 1961 bytes result sent to driver
2021-11-30 19:58:25 INFO  Executor:54 - Finished task 3.0 in stage 0.0 (TID 3). 1961 bytes result sent to driver
2021-11-30 19:58:25 INFO  Executor:54 - Finished task 0.0 in stage 0.0 (TID 0). 1961 bytes result sent to driver
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Finished task 2.0 in stage 0.0 (TID 2) in 1271 ms on localhost (executor driver) (1/4)
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Finished task 0.0 in stage 0.0 (TID 0) in 1316 ms on localhost (executor driver) (2/4)
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Finished task 3.0 in stage 0.0 (TID 3) in 1270 ms on localhost (executor driver) (3/4)
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Finished task 1.0 in stage 0.0 (TID 1) in 1293 ms on localhost (executor driver) (4/4)
2021-11-30 19:58:25 INFO  TaskSchedulerImpl:54 - Removed TaskSet 0.0, whose tasks have all completed, from pool 
2021-11-30 19:58:25 INFO  DAGScheduler:54 - ShuffleMapStage 0 (foreachPartition at KnnAlgorithm.scala:846) finished in 1.564 s
2021-11-30 19:58:25 INFO  DAGScheduler:54 - looking for newly runnable stages
2021-11-30 19:58:25 INFO  DAGScheduler:54 - running: Set()
2021-11-30 19:58:25 INFO  DAGScheduler:54 - waiting: Set(ResultStage 1)
2021-11-30 19:58:25 INFO  DAGScheduler:54 - failed: Set()
2021-11-30 19:58:25 INFO  DAGScheduler:54 - Submitting ResultStage 1 (MapPartitionsRDD[15] at foreachPartition at KnnAlgorithm.scala:846), which has no missing parents
2021-11-30 19:58:25 INFO  MemoryStore:54 - Block broadcast_1 stored as values in memory (estimated size 85.4 KB, free 2.5 GB)
2021-11-30 19:58:25 INFO  MemoryStore:54 - Block broadcast_1_piece0 stored as bytes in memory (estimated size 33.0 KB, free 2.5 GB)
2021-11-30 19:58:25 INFO  BlockManagerInfo:54 - Added broadcast_1_piece0 in memory on 10.162.40.121:58825 (size: 33.0 KB, free: 2.5 GB)
2021-11-30 19:58:25 INFO  SparkContext:54 - Created broadcast 1 from broadcast at DAGScheduler.scala:1039
2021-11-30 19:58:25 INFO  DAGScheduler:54 - Submitting 4 missing tasks from ResultStage 1 (MapPartitionsRDD[15] at foreachPartition at KnnAlgorithm.scala:846) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
2021-11-30 19:58:25 INFO  TaskSchedulerImpl:54 - Adding task set 1.0 with 4 tasks
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Starting task 0.0 in stage 1.0 (TID 4, localhost, executor driver, partition 0, ANY, 7754 bytes)
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Starting task 1.0 in stage 1.0 (TID 5, localhost, executor driver, partition 1, ANY, 7754 bytes)
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Starting task 2.0 in stage 1.0 (TID 6, localhost, executor driver, partition 2, ANY, 7754 bytes)
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Starting task 3.0 in stage 1.0 (TID 7, localhost, executor driver, partition 3, ANY, 7754 bytes)
2021-11-30 19:58:25 INFO  Executor:54 - Running task 2.0 in stage 1.0 (TID 6)
2021-11-30 19:58:25 INFO  Executor:54 - Running task 0.0 in stage 1.0 (TID 4)
2021-11-30 19:58:25 INFO  Executor:54 - Running task 3.0 in stage 1.0 (TID 7)
2021-11-30 19:58:25 INFO  Executor:54 - Running task 1.0 in stage 1.0 (TID 5)
2021-11-30 19:58:25 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 19:58:25 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 19:58:25 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 19:58:25 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 19:58:25 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 12 ms
2021-11-30 19:58:25 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 13 ms
2021-11-30 19:58:25 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 13 ms
2021-11-30 19:58:25 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 13 ms
2021-11-30 19:58:25 INFO  CodeGenerator:54 - Code generated in 14.4482 ms
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0000: started indexing 2490 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0002: started indexing 2507 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0001: started indexing 2518 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0003: started indexing 2485 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0003: finished indexing 2485 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0001: finished indexing 2518 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0002: finished indexing 2507 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0000: finished indexing 2490 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0000: started saving index to file:/tmp/76e4f196-3c16-4cf5-bd46-4a1662df159d/BruteForceSimilarity_4c1fb9025438cee2208a_1638273502363/0 on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0002: started saving index to file:/tmp/76e4f196-3c16-4cf5-bd46-4a1662df159d/BruteForceSimilarity_4c1fb9025438cee2208a_1638273502363/2 on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0003: started saving index to file:/tmp/76e4f196-3c16-4cf5-bd46-4a1662df159d/BruteForceSimilarity_4c1fb9025438cee2208a_1638273502363/3 on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0001: started saving index to file:/tmp/76e4f196-3c16-4cf5-bd46-4a1662df159d/BruteForceSimilarity_4c1fb9025438cee2208a_1638273502363/1 on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0003: finished saving index to file:/tmp/76e4f196-3c16-4cf5-bd46-4a1662df159d/BruteForceSimilarity_4c1fb9025438cee2208a_1638273502363/3 on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0002: finished saving index to file:/tmp/76e4f196-3c16-4cf5-bd46-4a1662df159d/BruteForceSimilarity_4c1fb9025438cee2208a_1638273502363/2 on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0001: finished saving index to file:/tmp/76e4f196-3c16-4cf5-bd46-4a1662df159d/BruteForceSimilarity_4c1fb9025438cee2208a_1638273502363/1 on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  BruteForceSimilarity:54 - partition 0000: finished saving index to file:/tmp/76e4f196-3c16-4cf5-bd46-4a1662df159d/BruteForceSimilarity_4c1fb9025438cee2208a_1638273502363/0 on host LAPTOP-K1RS47MN
2021-11-30 19:58:25 INFO  Executor:54 - Finished task 0.0 in stage 1.0 (TID 4). 1985 bytes result sent to driver
2021-11-30 19:58:25 INFO  Executor:54 - Finished task 3.0 in stage 1.0 (TID 7). 1985 bytes result sent to driver
2021-11-30 19:58:25 INFO  Executor:54 - Finished task 1.0 in stage 1.0 (TID 5). 1985 bytes result sent to driver
2021-11-30 19:58:25 INFO  Executor:54 - Finished task 2.0 in stage 1.0 (TID 6). 1985 bytes result sent to driver
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Finished task 0.0 in stage 1.0 (TID 4) in 462 ms on localhost (executor driver) (1/4)
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Finished task 3.0 in stage 1.0 (TID 7) in 460 ms on localhost (executor driver) (2/4)
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Finished task 1.0 in stage 1.0 (TID 5) in 462 ms on localhost (executor driver) (3/4)
2021-11-30 19:58:25 INFO  TaskSetManager:54 - Finished task 2.0 in stage 1.0 (TID 6) in 462 ms on localhost (executor driver) (4/4)
2021-11-30 19:58:25 INFO  TaskSchedulerImpl:54 - Removed TaskSet 1.0, whose tasks have all completed, from pool 
2021-11-30 19:58:25 INFO  DAGScheduler:54 - ResultStage 1 (foreachPartition at KnnAlgorithm.scala:846) finished in 0.514 s
2021-11-30 19:58:25 INFO  DAGScheduler:54 - Job 0 finished: foreachPartition at KnnAlgorithm.scala:846, took 2.178592 s
2021-11-30 19:58:26 INFO  CleanupListener:54 - Deleting files below file:/tmp/76e4f196-3c16-4cf5-bd46-4a1662df159d/BruteForceSimilarity_4c1fb9025438cee2208a_1638273502363
2021-11-30 19:58:26 INFO  AbstractConnector:318 - Stopped Spark@12d8416c{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2021-11-30 19:58:26 INFO  SparkUI:54 - Stopped Spark web UI at http://10.162.40.121:4040
2021-11-30 19:58:26 INFO  MapOutputTrackerMasterEndpoint:54 - MapOutputTrackerMasterEndpoint stopped!
2021-11-30 19:58:26 INFO  MemoryStore:54 - MemoryStore cleared
2021-11-30 19:58:26 INFO  BlockManager:54 - BlockManager stopped
2021-11-30 19:58:26 INFO  BlockManagerMaster:54 - BlockManagerMaster stopped
2021-11-30 19:58:26 INFO  OutputCommitCoordinator$OutputCommitCoordinatorEndpoint:54 - OutputCommitCoordinator stopped!
2021-11-30 19:58:26 INFO  SparkContext:54 - Successfully stopped SparkContext
bruteForce
 456.1889171600342
2021-11-30 19:58:26 INFO  SparkContext:54 - Running Spark version 2.3.0
2021-11-30 19:58:26 INFO  SparkContext:54 - Submitted application: mytest
2021-11-30 19:58:26 INFO  SecurityManager:54 - Changing view acls to: yaoheng
2021-11-30 19:58:26 INFO  SecurityManager:54 - Changing modify acls to: yaoheng
2021-11-30 19:58:26 INFO  SecurityManager:54 - Changing view acls groups to: 
2021-11-30 19:58:26 INFO  SecurityManager:54 - Changing modify acls groups to: 
2021-11-30 19:58:26 INFO  SecurityManager:54 - SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(yaoheng); groups with view permissions: Set(); users  with modify permissions: Set(yaoheng); groups with modify permissions: Set()
2021-11-30 19:58:26 INFO  Utils:54 - Successfully started service 'sparkDriver' on port 58835.
2021-11-30 19:58:26 INFO  SparkEnv:54 - Registering MapOutputTracker
2021-11-30 19:58:26 INFO  SparkEnv:54 - Registering BlockManagerMaster
2021-11-30 19:58:26 INFO  BlockManagerMasterEndpoint:54 - Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2021-11-30 19:58:26 INFO  BlockManagerMasterEndpoint:54 - BlockManagerMasterEndpoint up
2021-11-30 19:58:26 INFO  DiskBlockManager:54 - Created local directory at /tmp/blockmgr-db975fee-dfc3-489d-a1af-83070be68edf
2021-11-30 19:58:26 INFO  MemoryStore:54 - MemoryStore started with capacity 2.5 GB
2021-11-30 19:58:26 INFO  SparkEnv:54 - Registering OutputCommitCoordinator
2021-11-30 19:58:26 INFO  Server:346 - jetty-9.3.z-SNAPSHOT
2021-11-30 19:58:26 INFO  Server:414 - Started @12315ms
2021-11-30 19:58:26 INFO  AbstractConnector:278 - Started ServerConnector@3033cd68{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2021-11-30 19:58:26 INFO  Utils:54 - Successfully started service 'SparkUI' on port 4040.
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1365aae6{/jobs,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2caef572{/jobs/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@31ce1591{/jobs/job,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1fb8d64d{/jobs/job/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@21b46dc6{/stages,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7a6a19e7{/stages/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3bc9e9a6{/stages/stage,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@629a4a2c{/stages/stage/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6042d1e4{/stages/pool,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4acd492a{/stages/pool/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3ebd0d0c{/storage,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@e46ebdd{/storage/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@787dd600{/storage/rdd,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5859543c{/storage/rdd/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@e5ae756{/environment,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@377bed43{/environment/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@21a0e07a{/executors,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@33cab8c6{/executors/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6af389be{/executors/threadDump,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@28a6056{/executors/threadDump/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@248ff34d{/static,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@42e56392{/,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@34adbc09{/api,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3eba6062{/jobs/job/kill,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@57aa7dd4{/stages/stage/kill,null,AVAILABLE,@Spark}
2021-11-30 19:58:26 INFO  SparkUI:54 - Bound SparkUI to 0.0.0.0, and started at http://10.162.40.121:4040
2021-11-30 19:58:26 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar at spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638273506872
2021-11-30 19:58:26 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar at spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638273506872
2021-11-30 19:58:26 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar at spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638273506873
2021-11-30 19:58:26 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar at spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638273506873
2021-11-30 19:58:26 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at spark://10.162.40.121:58835/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638273506873
2021-11-30 19:58:26 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at spark://10.162.40.121:58835/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638273506873
2021-11-30 19:58:26 INFO  SparkContext:54 - Added file file:/home/yaoheng/test/spark-aknn/test/test.py at file:/home/yaoheng/test/spark-aknn/test/test.py with timestamp 1638273506873
2021-11-30 19:58:26 INFO  Utils:54 - Copying /home/yaoheng/test/spark-aknn/test/test.py to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/test.py
2021-11-30 19:58:26 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638273506885
2021-11-30 19:58:26 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 19:58:26 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638273506898
2021-11-30 19:58:26 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 19:58:26 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638273506909
2021-11-30 19:58:26 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 19:58:26 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638273506922
2021-11-30 19:58:26 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 19:58:26 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638273506934
2021-11-30 19:58:26 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 19:58:26 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638273506963
2021-11-30 19:58:26 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 19:58:26 INFO  Executor:54 - Starting executor ID driver on host localhost
2021-11-30 19:58:26 INFO  Utils:54 - Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 58836.
2021-11-30 19:58:26 INFO  NettyBlockTransferService:54 - Server created on 10.162.40.121:58836
2021-11-30 19:58:26 INFO  BlockManager:54 - Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2021-11-30 19:58:26 INFO  BlockManagerMaster:54 - Registering BlockManager BlockManagerId(driver, 10.162.40.121, 58836, None)
2021-11-30 19:58:26 INFO  BlockManagerMasterEndpoint:54 - Registering block manager 10.162.40.121:58836 with 2.5 GB RAM, BlockManagerId(driver, 10.162.40.121, 58836, None)
2021-11-30 19:58:26 INFO  BlockManagerMaster:54 - Registered BlockManager BlockManagerId(driver, 10.162.40.121, 58836, None)
2021-11-30 19:58:26 INFO  BlockManager:54 - Initialized BlockManager: BlockManagerId(driver, 10.162.40.121, 58836, None)
2021-11-30 19:58:26 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5eecc67{/metrics/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:27 INFO  SharedState:54 - Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/home/yaoheng/test/spark-aknn/spark-warehouse/').
2021-11-30 19:58:27 INFO  SharedState:54 - Warehouse path is 'file:/home/yaoheng/test/spark-aknn/spark-warehouse/'.
2021-11-30 19:58:27 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@674b65a1{/SQL,null,AVAILABLE,@Spark}
2021-11-30 19:58:27 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@50621907{/SQL/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:27 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2c73cbf0{/SQL/execution,null,AVAILABLE,@Spark}
2021-11-30 19:58:27 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@664cd727{/SQL/execution/json,null,AVAILABLE,@Spark}
2021-11-30 19:58:27 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@38ea5d7a{/static/sql,null,AVAILABLE,@Spark}
2021-11-30 19:58:27 INFO  StateStoreCoordinatorRef:54 - Registered StateStoreCoordinator endpoint
2021-11-30 19:58:27 INFO  SparkContext:54 - Starting job: foreachPartition at KnnAlgorithm.scala:846
2021-11-30 19:58:27 INFO  DAGScheduler:54 - Registering RDD 17 (foreachPartition at KnnAlgorithm.scala:846)
2021-11-30 19:58:27 INFO  DAGScheduler:54 - Got job 0 (foreachPartition at KnnAlgorithm.scala:846) with 4 output partitions
2021-11-30 19:58:27 INFO  DAGScheduler:54 - Final stage: ResultStage 1 (foreachPartition at KnnAlgorithm.scala:846)
2021-11-30 19:58:27 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 0)
2021-11-30 19:58:27 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 0)
2021-11-30 19:58:27 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 0 (MapPartitionsRDD[17] at foreachPartition at KnnAlgorithm.scala:846), which has no missing parents
2021-11-30 19:58:27 INFO  MemoryStore:54 - Block broadcast_0 stored as values in memory (estimated size 14.1 KB, free 2.5 GB)
2021-11-30 19:58:27 INFO  MemoryStore:54 - Block broadcast_0_piece0 stored as bytes in memory (estimated size 7.2 KB, free 2.5 GB)
2021-11-30 19:58:27 INFO  BlockManagerInfo:54 - Added broadcast_0_piece0 in memory on 10.162.40.121:58836 (size: 7.2 KB, free: 2.5 GB)
2021-11-30 19:58:27 INFO  SparkContext:54 - Created broadcast 0 from broadcast at DAGScheduler.scala:1039
2021-11-30 19:58:27 INFO  DAGScheduler:54 - Submitting 4 missing tasks from ShuffleMapStage 0 (MapPartitionsRDD[17] at foreachPartition at KnnAlgorithm.scala:846) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
2021-11-30 19:58:27 INFO  TaskSchedulerImpl:54 - Adding task set 0.0 with 4 tasks
2021-11-30 19:58:27 WARN  TaskSetManager:66 - Stage 0 contains a task of very large size (2343 KB). The maximum recommended task size is 100 KB.
2021-11-30 19:58:27 INFO  TaskSetManager:54 - Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, PROCESS_LOCAL, 2400194 bytes)
2021-11-30 19:58:27 INFO  TaskSetManager:54 - Starting task 1.0 in stage 0.0 (TID 1, localhost, executor driver, partition 1, PROCESS_LOCAL, 3596761 bytes)
2021-11-30 19:58:27 INFO  TaskSetManager:54 - Starting task 2.0 in stage 0.0 (TID 2, localhost, executor driver, partition 2, PROCESS_LOCAL, 2400450 bytes)
2021-11-30 19:58:27 INFO  TaskSetManager:54 - Starting task 3.0 in stage 0.0 (TID 3, localhost, executor driver, partition 3, PROCESS_LOCAL, 3316199 bytes)
2021-11-30 19:58:27 INFO  Executor:54 - Running task 0.0 in stage 0.0 (TID 0)
2021-11-30 19:58:27 INFO  Executor:54 - Running task 1.0 in stage 0.0 (TID 1)
2021-11-30 19:58:27 INFO  Executor:54 - Running task 2.0 in stage 0.0 (TID 2)
2021-11-30 19:58:27 INFO  Executor:54 - Running task 3.0 in stage 0.0 (TID 3)
2021-11-30 19:58:27 INFO  Executor:54 - Fetching file:/home/yaoheng/test/spark-aknn/test/test.py with timestamp 1638273506873
2021-11-30 19:58:27 INFO  Utils:54 - /home/yaoheng/test/spark-aknn/test/test.py has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/test.py
2021-11-30 19:58:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638273506934
2021-11-30 19:58:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 19:58:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638273506885
2021-11-30 19:58:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 19:58:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638273506909
2021-11-30 19:58:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 19:58:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638273506922
2021-11-30 19:58:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 19:58:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638273506898
2021-11-30 19:58:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 19:58:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638273506963
2021-11-30 19:58:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 19:58:27 INFO  Executor:54 - Fetching spark://10.162.40.121:58835/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638273506873
2021-11-30 19:58:27 INFO  TransportClientFactory:267 - Successfully created connection to /10.162.40.121:58835 after 2 ms (0 ms spent in bootstraps)
2021-11-30 19:58:27 INFO  Utils:54 - Fetching spark://10.162.40.121:58835/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp2821737333963302168.tmp
2021-11-30 19:58:27 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp2821737333963302168.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 19:58:27 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/org.eclipse.collections_eclipse-collections-9.2.0.jar to class loader
2021-11-30 19:58:27 INFO  Executor:54 - Fetching spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638273506873
2021-11-30 19:58:27 INFO  Utils:54 - Fetching spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp3334644358706330092.tmp
2021-11-30 19:58:27 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp3334644358706330092.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 19:58:27 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-core-0.0.49.jar to class loader
2021-11-30 19:58:27 INFO  Executor:54 - Fetching spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638273506872
2021-11-30 19:58:27 INFO  Utils:54 - Fetching spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp9149521437754842796.tmp
2021-11-30 19:58:27 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp9149521437754842796.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 19:58:27 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-utils-0.0.49.jar to class loader
2021-11-30 19:58:27 INFO  Executor:54 - Fetching spark://10.162.40.121:58835/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638273506873
2021-11-30 19:58:28 INFO  Utils:54 - Fetching spark://10.162.40.121:58835/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp1885732035390897255.tmp
2021-11-30 19:58:28 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp1885732035390897255.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 19:58:28 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to class loader
2021-11-30 19:58:28 INFO  Executor:54 - Fetching spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638273506872
2021-11-30 19:58:28 INFO  Utils:54 - Fetching spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp8616178563555358743.tmp
2021-11-30 19:58:28 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp8616178563555358743.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 19:58:28 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to class loader
2021-11-30 19:58:28 INFO  Executor:54 - Fetching spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638273506873
2021-11-30 19:58:28 INFO  Utils:54 - Fetching spark://10.162.40.121:58835/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp2701189334900631144.tmp
2021-11-30 19:58:28 INFO  Utils:54 - /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/fetchFileTemp2701189334900631144.tmp has been previously copied to /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 19:58:28 INFO  Executor:54 - Adding file:/tmp/spark-26e99329-0747-4681-9f06-294c1888389a/userFiles-6ff4288a-249d-4d7a-b8b2-715b77dcdfad/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to class loader
2021-11-30 19:58:28 INFO  ContextCleaner:54 - Cleaned accumulator 58
2021-11-30 19:58:28 INFO  PythonRunner:54 - Times: total = 462, boot = 402, init = 2, finish = 58
2021-11-30 19:58:28 INFO  PythonRunner:54 - Times: total = 469, boot = 421, init = 3, finish = 45
2021-11-30 19:58:28 INFO  PythonRunner:54 - Times: total = 476, boot = 412, init = 1, finish = 63
2021-11-30 19:58:28 INFO  PythonRunner:54 - Times: total = 486, boot = 436, init = 4, finish = 46
2021-11-30 19:58:28 INFO  Executor:54 - Finished task 0.0 in stage 0.0 (TID 0). 1918 bytes result sent to driver
2021-11-30 19:58:28 INFO  TaskSetManager:54 - Finished task 0.0 in stage 0.0 (TID 0) in 985 ms on localhost (executor driver) (1/4)
2021-11-30 19:58:28 INFO  Executor:54 - Finished task 1.0 in stage 0.0 (TID 1). 1875 bytes result sent to driver
2021-11-30 19:58:28 INFO  TaskSetManager:54 - Finished task 1.0 in stage 0.0 (TID 1) in 986 ms on localhost (executor driver) (2/4)
2021-11-30 19:58:28 INFO  Executor:54 - Finished task 3.0 in stage 0.0 (TID 3). 1875 bytes result sent to driver
2021-11-30 19:58:28 INFO  TaskSetManager:54 - Finished task 3.0 in stage 0.0 (TID 3) in 983 ms on localhost (executor driver) (3/4)
2021-11-30 19:58:28 INFO  Executor:54 - Finished task 2.0 in stage 0.0 (TID 2). 1875 bytes result sent to driver
2021-11-30 19:58:28 INFO  TaskSetManager:54 - Finished task 2.0 in stage 0.0 (TID 2) in 989 ms on localhost (executor driver) (4/4)
2021-11-30 19:58:28 INFO  TaskSchedulerImpl:54 - Removed TaskSet 0.0, whose tasks have all completed, from pool 
2021-11-30 19:58:28 INFO  DAGScheduler:54 - ShuffleMapStage 0 (foreachPartition at KnnAlgorithm.scala:846) finished in 1.004 s
2021-11-30 19:58:28 INFO  DAGScheduler:54 - looking for newly runnable stages
2021-11-30 19:58:28 INFO  DAGScheduler:54 - running: Set()
2021-11-30 19:58:28 INFO  DAGScheduler:54 - waiting: Set(ResultStage 1)
2021-11-30 19:58:28 INFO  DAGScheduler:54 - failed: Set()
2021-11-30 19:58:28 INFO  DAGScheduler:54 - Submitting ResultStage 1 (MapPartitionsRDD[20] at foreachPartition at KnnAlgorithm.scala:846), which has no missing parents
2021-11-30 19:58:28 INFO  MemoryStore:54 - Block broadcast_1 stored as values in memory (estimated size 85.9 KB, free 2.5 GB)
2021-11-30 19:58:28 INFO  MemoryStore:54 - Block broadcast_1_piece0 stored as bytes in memory (estimated size 33.2 KB, free 2.5 GB)
2021-11-30 19:58:28 INFO  BlockManagerInfo:54 - Added broadcast_1_piece0 in memory on 10.162.40.121:58836 (size: 33.2 KB, free: 2.5 GB)
2021-11-30 19:58:28 INFO  SparkContext:54 - Created broadcast 1 from broadcast at DAGScheduler.scala:1039
2021-11-30 19:58:28 INFO  DAGScheduler:54 - Submitting 4 missing tasks from ResultStage 1 (MapPartitionsRDD[20] at foreachPartition at KnnAlgorithm.scala:846) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
2021-11-30 19:58:28 INFO  TaskSchedulerImpl:54 - Adding task set 1.0 with 4 tasks
2021-11-30 19:58:28 INFO  TaskSetManager:54 - Starting task 0.0 in stage 1.0 (TID 4, localhost, executor driver, partition 0, ANY, 7754 bytes)
2021-11-30 19:58:28 INFO  TaskSetManager:54 - Starting task 1.0 in stage 1.0 (TID 5, localhost, executor driver, partition 1, ANY, 7754 bytes)
2021-11-30 19:58:28 INFO  TaskSetManager:54 - Starting task 2.0 in stage 1.0 (TID 6, localhost, executor driver, partition 2, ANY, 7754 bytes)
2021-11-30 19:58:28 INFO  TaskSetManager:54 - Starting task 3.0 in stage 1.0 (TID 7, localhost, executor driver, partition 3, ANY, 7754 bytes)
2021-11-30 19:58:28 INFO  Executor:54 - Running task 1.0 in stage 1.0 (TID 5)
2021-11-30 19:58:28 INFO  Executor:54 - Running task 0.0 in stage 1.0 (TID 4)
2021-11-30 19:58:28 INFO  Executor:54 - Running task 3.0 in stage 1.0 (TID 7)
2021-11-30 19:58:28 INFO  Executor:54 - Running task 2.0 in stage 1.0 (TID 6)
2021-11-30 19:58:28 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 19:58:28 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2021-11-30 19:58:28 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 19:58:28 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 19:58:28 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 19:58:28 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2021-11-30 19:58:28 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2021-11-30 19:58:28 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2021-11-30 19:58:28 INFO  CodeGenerator:54 - Code generated in 29.9787 ms
2021-11-30 19:58:28 INFO  HnswSimilarity:54 - partition 0002: started indexing 2507 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:28 INFO  HnswSimilarity:54 - partition 0000: started indexing 2490 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:28 INFO  HnswSimilarity:54 - partition 0003: started indexing 2485 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:28 INFO  HnswSimilarity:54 - partition 0001: started indexing 2518 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0000: finished indexing 2490 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0003: finished indexing 2485 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0001: finished indexing 2518 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0000: started saving index to file:/tmp/a978713a-bb44-4bec-9a51-aa1f30d33efb/HnswSimilarity_4b58a4c7f0033dda7395_1638273507641/0 on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0003: started saving index to file:/tmp/a978713a-bb44-4bec-9a51-aa1f30d33efb/HnswSimilarity_4b58a4c7f0033dda7395_1638273507641/3 on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0002: finished indexing 2507 items on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0001: started saving index to file:/tmp/a978713a-bb44-4bec-9a51-aa1f30d33efb/HnswSimilarity_4b58a4c7f0033dda7395_1638273507641/1 on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0002: started saving index to file:/tmp/a978713a-bb44-4bec-9a51-aa1f30d33efb/HnswSimilarity_4b58a4c7f0033dda7395_1638273507641/2 on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0002: finished saving index to file:/tmp/a978713a-bb44-4bec-9a51-aa1f30d33efb/HnswSimilarity_4b58a4c7f0033dda7395_1638273507641/2 on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  Executor:54 - Finished task 2.0 in stage 1.0 (TID 6). 1856 bytes result sent to driver
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0001: finished saving index to file:/tmp/a978713a-bb44-4bec-9a51-aa1f30d33efb/HnswSimilarity_4b58a4c7f0033dda7395_1638273507641/1 on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  TaskSetManager:54 - Finished task 2.0 in stage 1.0 (TID 6) in 935 ms on localhost (executor driver) (1/4)
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0000: finished saving index to file:/tmp/a978713a-bb44-4bec-9a51-aa1f30d33efb/HnswSimilarity_4b58a4c7f0033dda7395_1638273507641/0 on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  Executor:54 - Finished task 1.0 in stage 1.0 (TID 5). 1856 bytes result sent to driver
2021-11-30 19:58:29 INFO  HnswSimilarity:54 - partition 0003: finished saving index to file:/tmp/a978713a-bb44-4bec-9a51-aa1f30d33efb/HnswSimilarity_4b58a4c7f0033dda7395_1638273507641/3 on host LAPTOP-K1RS47MN
2021-11-30 19:58:29 INFO  TaskSetManager:54 - Finished task 1.0 in stage 1.0 (TID 5) in 937 ms on localhost (executor driver) (2/4)
2021-11-30 19:58:29 INFO  Executor:54 - Finished task 0.0 in stage 1.0 (TID 4). 1856 bytes result sent to driver
2021-11-30 19:58:29 INFO  Executor:54 - Finished task 3.0 in stage 1.0 (TID 7). 1856 bytes result sent to driver
2021-11-30 19:58:29 INFO  TaskSetManager:54 - Finished task 0.0 in stage 1.0 (TID 4) in 939 ms on localhost (executor driver) (3/4)
2021-11-30 19:58:29 INFO  TaskSetManager:54 - Finished task 3.0 in stage 1.0 (TID 7) in 939 ms on localhost (executor driver) (4/4)
2021-11-30 19:58:29 INFO  TaskSchedulerImpl:54 - Removed TaskSet 1.0, whose tasks have all completed, from pool 
2021-11-30 19:58:29 INFO  DAGScheduler:54 - ResultStage 1 (foreachPartition at KnnAlgorithm.scala:846) finished in 0.956 s
2021-11-30 19:58:29 INFO  DAGScheduler:54 - Job 0 finished: foreachPartition at KnnAlgorithm.scala:846, took 1.967652 s
2021-11-30 19:58:29 INFO  CleanupListener:54 - Deleting files below file:/tmp/a978713a-bb44-4bec-9a51-aa1f30d33efb/HnswSimilarity_4b58a4c7f0033dda7395_1638273507641
2021-11-30 19:58:29 INFO  AbstractConnector:318 - Stopped Spark@3033cd68{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2021-11-30 19:58:29 INFO  SparkUI:54 - Stopped Spark web UI at http://10.162.40.121:4040
2021-11-30 19:58:29 INFO  MapOutputTrackerMasterEndpoint:54 - MapOutputTrackerMasterEndpoint stopped!
2021-11-30 19:58:29 INFO  MemoryStore:54 - MemoryStore cleared
2021-11-30 19:58:29 INFO  BlockManager:54 - BlockManager stopped
2021-11-30 19:58:29 INFO  BlockManagerMaster:54 - BlockManagerMaster stopped
2021-11-30 19:58:29 INFO  OutputCommitCoordinator$OutputCommitCoordinatorEndpoint:54 - OutputCommitCoordinator stopped!
2021-11-30 19:58:29 INFO  SparkContext:54 - Successfully stopped SparkContext
 456.1889171600342
testmain_naiveSparkHnsw
 230.7872772216797
2021-11-30 19:58:30 INFO  ShutdownHookManager:54 - Shutdown hook called
2021-11-30 19:58:30 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-781b37d2-b441-4b76-8e91-90b7dec495d4
2021-11-30 19:58:30 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/pyspark-b384bb1f-c8b2-457e-b5f1-690ddd95e6a9
2021-11-30 19:58:30 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-26e99329-0747-4681-9f06-294c1888389a
2021-11-30 19:58:30 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-26e99329-0747-4681-9f06-294c1888389a/pyspark-8a709533-477c-41a1-b420-1e82da09c475
maxelement = 100000000
k=10
partitionnum=4
ef = int(1.5*k)
sc = 1
m = int(30)
distanceFunction='euclidean'

