2021-11-30 20:25:21 WARN  Utils:66 - Your hostname, LAPTOP-K1RS47MN resolves to a loopback address: 127.0.1.1; using 10.162.40.121 instead (on interface wifi0)
2021-11-30 20:25:21 WARN  Utils:66 - Set SPARK_LOCAL_IP if you need to bind to another address
2021-11-30 20:25:21 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2021-11-30 20:25:24 INFO  SparkContext:54 - Running Spark version 2.3.0
2021-11-30 20:25:24 INFO  SparkContext:54 - Submitted application: mytest
2021-11-30 20:25:24 INFO  SecurityManager:54 - Changing view acls to: yaoheng
2021-11-30 20:25:24 INFO  SecurityManager:54 - Changing modify acls to: yaoheng
2021-11-30 20:25:24 INFO  SecurityManager:54 - Changing view acls groups to: 
2021-11-30 20:25:24 INFO  SecurityManager:54 - Changing modify acls groups to: 
2021-11-30 20:25:24 INFO  SecurityManager:54 - SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(yaoheng); groups with view permissions: Set(); users  with modify permissions: Set(yaoheng); groups with modify permissions: Set()
2021-11-30 20:25:24 INFO  Utils:54 - Successfully started service 'sparkDriver' on port 59696.
2021-11-30 20:25:24 INFO  SparkEnv:54 - Registering MapOutputTracker
2021-11-30 20:25:24 INFO  SparkEnv:54 - Registering BlockManagerMaster
2021-11-30 20:25:24 INFO  BlockManagerMasterEndpoint:54 - Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2021-11-30 20:25:24 INFO  BlockManagerMasterEndpoint:54 - BlockManagerMasterEndpoint up
2021-11-30 20:25:24 INFO  DiskBlockManager:54 - Created local directory at /tmp/blockmgr-243fa4fd-c82a-4b7e-918d-057dd87c7bb6
2021-11-30 20:25:24 INFO  MemoryStore:54 - MemoryStore started with capacity 2.5 GB
2021-11-30 20:25:24 INFO  SparkEnv:54 - Registering OutputCommitCoordinator
2021-11-30 20:25:25 INFO  log:192 - Logging initialized @5070ms
2021-11-30 20:25:25 INFO  Server:346 - jetty-9.3.z-SNAPSHOT
2021-11-30 20:25:25 INFO  Server:414 - Started @5158ms
2021-11-30 20:25:25 INFO  AbstractConnector:278 - Started ServerConnector@6107ded7{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2021-11-30 20:25:25 INFO  Utils:54 - Successfully started service 'SparkUI' on port 4040.
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@46faf839{/jobs,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@327bf1bc{/jobs/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@46427b19{/jobs/job,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@50aa5ca8{/jobs/job/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3db1b110{/stages,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@68fe8f0c{/stages/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7c41bdeb{/stages/stage,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@521f9614{/stages/stage/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2340d759{/stages/pool,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3a5b08af{/stages/pool/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5b8e658d{/storage,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@758fe7de{/storage/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@50d00c29{/storage/rdd,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@322c78ec{/storage/rdd/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1a26d129{/environment,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@109d64a4{/environment/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@407c83da{/executors,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@11c66821{/executors/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3dc54ca9{/executors/threadDump,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4606b7f1{/executors/threadDump/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@62408eb8{/static,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@9de7fd4{/,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@75b6e78{/api,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@124a5ea5{/jobs/job/kill,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6850d353{/stages/stage/kill,null,AVAILABLE,@Spark}
2021-11-30 20:25:25 INFO  SparkUI:54 - Bound SparkUI to 0.0.0.0, and started at http://10.162.40.121:4040
2021-11-30 20:25:25 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar at spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638275125299
2021-11-30 20:25:25 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar at spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638275125300
2021-11-30 20:25:25 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar at spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638275125301
2021-11-30 20:25:25 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar at spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638275125301
2021-11-30 20:25:25 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at spark://10.162.40.121:59696/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638275125301
2021-11-30 20:25:25 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at spark://10.162.40.121:59696/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638275125301
2021-11-30 20:25:25 INFO  SparkContext:54 - Added file file:/home/yaoheng/test/spark-aknn/test/test.py at file:/home/yaoheng/test/spark-aknn/test/test.py with timestamp 1638275125302
2021-11-30 20:25:25 INFO  Utils:54 - Copying /home/yaoheng/test/spark-aknn/test/test.py to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/test.py
2021-11-30 20:25:25 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638275125323
2021-11-30 20:25:25 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 20:25:25 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638275125334
2021-11-30 20:25:25 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 20:25:25 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638275125344
2021-11-30 20:25:25 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 20:25:25 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638275125355
2021-11-30 20:25:25 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 20:25:25 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638275125366
2021-11-30 20:25:25 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 20:25:25 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638275125396
2021-11-30 20:25:25 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 20:25:25 INFO  Executor:54 - Starting executor ID driver on host localhost
2021-11-30 20:25:25 INFO  Utils:54 - Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 59697.
2021-11-30 20:25:25 INFO  NettyBlockTransferService:54 - Server created on 10.162.40.121:59697
2021-11-30 20:25:25 INFO  BlockManager:54 - Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2021-11-30 20:25:25 INFO  BlockManagerMaster:54 - Registering BlockManager BlockManagerId(driver, 10.162.40.121, 59697, None)
2021-11-30 20:25:25 INFO  BlockManagerMasterEndpoint:54 - Registering block manager 10.162.40.121:59697 with 2.5 GB RAM, BlockManagerId(driver, 10.162.40.121, 59697, None)
2021-11-30 20:25:25 INFO  BlockManagerMaster:54 - Registered BlockManager BlockManagerId(driver, 10.162.40.121, 59697, None)
2021-11-30 20:25:25 INFO  BlockManager:54 - Initialized BlockManager: BlockManagerId(driver, 10.162.40.121, 59697, None)
2021-11-30 20:25:25 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2e9e6783{/metrics/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:30 INFO  SharedState:54 - Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/home/yaoheng/test/spark-aknn/spark-warehouse/').
2021-11-30 20:25:30 INFO  SharedState:54 - Warehouse path is 'file:/home/yaoheng/test/spark-aknn/spark-warehouse/'.
2021-11-30 20:25:30 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1a6c72c0{/SQL,null,AVAILABLE,@Spark}
2021-11-30 20:25:30 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@32d09224{/SQL/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:30 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@47aa6227{/SQL/execution,null,AVAILABLE,@Spark}
2021-11-30 20:25:30 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@37034d32{/SQL/execution/json,null,AVAILABLE,@Spark}
2021-11-30 20:25:30 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@569918a{/static/sql,null,AVAILABLE,@Spark}
2021-11-30 20:25:30 INFO  StateStoreCoordinatorRef:54 - Registered StateStoreCoordinator endpoint
2021-11-30 20:25:53 INFO  CodeGenerator:54 - Code generated in 210.1662 ms
2021-11-30 20:25:53 INFO  SparkContext:54 - Starting job: foreachPartition at KnnAlgorithm.scala:846
2021-11-30 20:25:53 INFO  DAGScheduler:54 - Registering RDD 12 (foreachPartition at KnnAlgorithm.scala:846)
2021-11-30 20:25:53 INFO  DAGScheduler:54 - Got job 0 (foreachPartition at KnnAlgorithm.scala:846) with 4 output partitions
2021-11-30 20:25:53 INFO  DAGScheduler:54 - Final stage: ResultStage 1 (foreachPartition at KnnAlgorithm.scala:846)
2021-11-30 20:25:53 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 0)
2021-11-30 20:25:53 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 0)
2021-11-30 20:25:53 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 0 (MapPartitionsRDD[12] at foreachPartition at KnnAlgorithm.scala:846), which has no missing parents
2021-11-30 20:25:53 INFO  MemoryStore:54 - Block broadcast_0 stored as values in memory (estimated size 14.1 KB, free 2.5 GB)
2021-11-30 20:25:53 INFO  MemoryStore:54 - Block broadcast_0_piece0 stored as bytes in memory (estimated size 7.2 KB, free 2.5 GB)
2021-11-30 20:25:53 INFO  BlockManagerInfo:54 - Added broadcast_0_piece0 in memory on 10.162.40.121:59697 (size: 7.2 KB, free: 2.5 GB)
2021-11-30 20:25:53 INFO  SparkContext:54 - Created broadcast 0 from broadcast at DAGScheduler.scala:1039
2021-11-30 20:25:53 INFO  DAGScheduler:54 - Submitting 4 missing tasks from ShuffleMapStage 0 (MapPartitionsRDD[12] at foreachPartition at KnnAlgorithm.scala:846) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
2021-11-30 20:25:53 INFO  TaskSchedulerImpl:54 - Adding task set 0.0 with 4 tasks
2021-11-30 20:25:53 INFO  ContextCleaner:54 - Cleaned accumulator 1
2021-11-30 20:25:53 WARN  TaskSetManager:66 - Stage 0 contains a task of very large size (113395 KB). The maximum recommended task size is 100 KB.
2021-11-30 20:25:53 INFO  TaskSetManager:54 - Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, PROCESS_LOCAL, 116117323 bytes)
2021-11-30 20:25:53 INFO  TaskSetManager:54 - Starting task 1.0 in stage 0.0 (TID 1, localhost, executor driver, partition 1, PROCESS_LOCAL, 117447010 bytes)
2021-11-30 20:25:54 INFO  TaskSetManager:54 - Starting task 2.0 in stage 0.0 (TID 2, localhost, executor driver, partition 2, PROCESS_LOCAL, 117447010 bytes)
2021-11-30 20:25:54 INFO  TaskSetManager:54 - Starting task 3.0 in stage 0.0 (TID 3, localhost, executor driver, partition 3, PROCESS_LOCAL, 116997344 bytes)
2021-11-30 20:25:54 INFO  Executor:54 - Running task 0.0 in stage 0.0 (TID 0)
2021-11-30 20:25:54 INFO  Executor:54 - Running task 3.0 in stage 0.0 (TID 3)
2021-11-30 20:25:54 INFO  Executor:54 - Running task 2.0 in stage 0.0 (TID 2)
2021-11-30 20:25:54 INFO  Executor:54 - Running task 1.0 in stage 0.0 (TID 1)
2021-11-30 20:25:54 INFO  Executor:54 - Fetching file:/home/yaoheng/test/spark-aknn/test/test.py with timestamp 1638275125302
2021-11-30 20:25:54 INFO  Utils:54 - /home/yaoheng/test/spark-aknn/test/test.py has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/test.py
2021-11-30 20:25:54 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638275125366
2021-11-30 20:25:54 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 20:25:54 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638275125323
2021-11-30 20:25:54 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 20:25:54 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638275125344
2021-11-30 20:25:54 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 20:25:54 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638275125355
2021-11-30 20:25:54 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 20:25:54 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638275125334
2021-11-30 20:25:54 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 20:25:54 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638275125396
2021-11-30 20:25:54 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 20:25:54 INFO  Executor:54 - Fetching spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638275125301
2021-11-30 20:25:54 INFO  TransportClientFactory:267 - Successfully created connection to /10.162.40.121:59696 after 38 ms (0 ms spent in bootstraps)
2021-11-30 20:25:54 INFO  Utils:54 - Fetching spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp6026403074661395905.tmp
2021-11-30 20:25:54 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp6026403074661395905.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 20:25:54 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to class loader
2021-11-30 20:25:54 INFO  Executor:54 - Fetching spark://10.162.40.121:59696/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638275125301
2021-11-30 20:25:54 INFO  Utils:54 - Fetching spark://10.162.40.121:59696/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp8414276323471500557.tmp
2021-11-30 20:25:54 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp8414276323471500557.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 20:25:54 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to class loader
2021-11-30 20:25:54 INFO  Executor:54 - Fetching spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638275125300
2021-11-30 20:25:54 INFO  Utils:54 - Fetching spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp1881777636709211276.tmp
2021-11-30 20:25:54 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp1881777636709211276.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 20:25:54 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-utils-0.0.49.jar to class loader
2021-11-30 20:25:54 INFO  Executor:54 - Fetching spark://10.162.40.121:59696/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638275125301
2021-11-30 20:25:54 INFO  Utils:54 - Fetching spark://10.162.40.121:59696/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp8601177970936078981.tmp
2021-11-30 20:25:54 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp8601177970936078981.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 20:25:54 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/org.eclipse.collections_eclipse-collections-9.2.0.jar to class loader
2021-11-30 20:25:54 INFO  Executor:54 - Fetching spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638275125299
2021-11-30 20:25:54 INFO  Utils:54 - Fetching spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp4481399266223867428.tmp
2021-11-30 20:25:54 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp4481399266223867428.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 20:25:54 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to class loader
2021-11-30 20:25:54 INFO  Executor:54 - Fetching spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638275125301
2021-11-30 20:25:54 INFO  Utils:54 - Fetching spark://10.162.40.121:59696/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp4118619378064862359.tmp
2021-11-30 20:25:54 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/fetchFileTemp4118619378064862359.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 20:25:54 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-d0634085-76c6-4250-84ec-db48c8c39dcf/com.github.jelmerk_hnswlib-core-0.0.49.jar to class loader
2021-11-30 20:25:55 INFO  CodeGenerator:54 - Code generated in 33.9373 ms
2021-11-30 20:25:55 INFO  CodeGenerator:54 - Code generated in 13.4133 ms
2021-11-30 20:25:59 INFO  PythonRunner:54 - Times: total = 4030, boot = 388, init = 2, finish = 3640
2021-11-30 20:25:59 INFO  PythonRunner:54 - Times: total = 4049, boot = 406, init = 2, finish = 3641
2021-11-30 20:25:59 INFO  PythonRunner:54 - Times: total = 4052, boot = 397, init = 2, finish = 3653
2021-11-30 20:25:59 INFO  PythonRunner:54 - Times: total = 4047, boot = 381, init = 7, finish = 3659
2021-11-30 20:25:59 INFO  Executor:54 - Finished task 1.0 in stage 0.0 (TID 1). 1961 bytes result sent to driver
2021-11-30 20:25:59 INFO  Executor:54 - Finished task 2.0 in stage 0.0 (TID 2). 1961 bytes result sent to driver
2021-11-30 20:25:59 INFO  Executor:54 - Finished task 3.0 in stage 0.0 (TID 3). 1961 bytes result sent to driver
2021-11-30 20:25:59 INFO  Executor:54 - Finished task 0.0 in stage 0.0 (TID 0). 1918 bytes result sent to driver
2021-11-30 20:25:59 INFO  TaskSetManager:54 - Finished task 0.0 in stage 0.0 (TID 0) in 5990 ms on localhost (executor driver) (1/4)
2021-11-30 20:25:59 INFO  TaskSetManager:54 - Finished task 3.0 in stage 0.0 (TID 3) in 5319 ms on localhost (executor driver) (2/4)
2021-11-30 20:25:59 INFO  TaskSetManager:54 - Finished task 1.0 in stage 0.0 (TID 1) in 5780 ms on localhost (executor driver) (3/4)
2021-11-30 20:25:59 INFO  TaskSetManager:54 - Finished task 2.0 in stage 0.0 (TID 2) in 5719 ms on localhost (executor driver) (4/4)
2021-11-30 20:25:59 INFO  TaskSchedulerImpl:54 - Removed TaskSet 0.0, whose tasks have all completed, from pool 
2021-11-30 20:25:59 INFO  DAGScheduler:54 - ShuffleMapStage 0 (foreachPartition at KnnAlgorithm.scala:846) finished in 6.217 s
2021-11-30 20:25:59 INFO  DAGScheduler:54 - looking for newly runnable stages
2021-11-30 20:25:59 INFO  DAGScheduler:54 - running: Set()
2021-11-30 20:25:59 INFO  DAGScheduler:54 - waiting: Set(ResultStage 1)
2021-11-30 20:25:59 INFO  DAGScheduler:54 - failed: Set()
2021-11-30 20:25:59 INFO  DAGScheduler:54 - Submitting ResultStage 1 (MapPartitionsRDD[15] at foreachPartition at KnnAlgorithm.scala:846), which has no missing parents
2021-11-30 20:25:59 INFO  MemoryStore:54 - Block broadcast_1 stored as values in memory (estimated size 85.4 KB, free 2.5 GB)
2021-11-30 20:25:59 INFO  MemoryStore:54 - Block broadcast_1_piece0 stored as bytes in memory (estimated size 33.0 KB, free 2.5 GB)
2021-11-30 20:25:59 INFO  BlockManagerInfo:54 - Added broadcast_1_piece0 in memory on 10.162.40.121:59697 (size: 33.0 KB, free: 2.5 GB)
2021-11-30 20:25:59 INFO  SparkContext:54 - Created broadcast 1 from broadcast at DAGScheduler.scala:1039
2021-11-30 20:25:59 INFO  DAGScheduler:54 - Submitting 4 missing tasks from ResultStage 1 (MapPartitionsRDD[15] at foreachPartition at KnnAlgorithm.scala:846) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
2021-11-30 20:25:59 INFO  TaskSchedulerImpl:54 - Adding task set 1.0 with 4 tasks
2021-11-30 20:25:59 INFO  TaskSetManager:54 - Starting task 0.0 in stage 1.0 (TID 4, localhost, executor driver, partition 0, ANY, 7754 bytes)
2021-11-30 20:25:59 INFO  TaskSetManager:54 - Starting task 1.0 in stage 1.0 (TID 5, localhost, executor driver, partition 1, ANY, 7754 bytes)
2021-11-30 20:25:59 INFO  TaskSetManager:54 - Starting task 2.0 in stage 1.0 (TID 6, localhost, executor driver, partition 2, ANY, 7754 bytes)
2021-11-30 20:25:59 INFO  TaskSetManager:54 - Starting task 3.0 in stage 1.0 (TID 7, localhost, executor driver, partition 3, ANY, 7754 bytes)
2021-11-30 20:25:59 INFO  Executor:54 - Running task 0.0 in stage 1.0 (TID 4)
2021-11-30 20:25:59 INFO  Executor:54 - Running task 3.0 in stage 1.0 (TID 7)
2021-11-30 20:25:59 INFO  Executor:54 - Running task 2.0 in stage 1.0 (TID 6)
2021-11-30 20:25:59 INFO  Executor:54 - Running task 1.0 in stage 1.0 (TID 5)
2021-11-30 20:25:59 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 20:25:59 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 20:25:59 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 20:25:59 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 20:25:59 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 10 ms
2021-11-30 20:25:59 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 10 ms
2021-11-30 20:25:59 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 10 ms
2021-11-30 20:25:59 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 10 ms
2021-11-30 20:25:59 INFO  CodeGenerator:54 - Code generated in 11.8251 ms
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0000: started indexing 99810 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0001: started indexing 99769 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0002: started indexing 100307 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0003: started indexing 100114 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BlockManagerInfo:54 - Removed broadcast_0_piece0 on 10.162.40.121:59697 in memory (size: 7.2 KB, free: 2.5 GB)
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0003: finished indexing 100114 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0001: finished indexing 99769 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0002: finished indexing 100307 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0000: finished indexing 99810 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0001: started saving index to file:/tmp/7b995c85-d504-4fbf-b2de-1414803eb410/BruteForceSimilarity_41dab0fe9291f3bcca7b_1638275152145/1 on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0000: started saving index to file:/tmp/7b995c85-d504-4fbf-b2de-1414803eb410/BruteForceSimilarity_41dab0fe9291f3bcca7b_1638275152145/0 on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0003: started saving index to file:/tmp/7b995c85-d504-4fbf-b2de-1414803eb410/BruteForceSimilarity_41dab0fe9291f3bcca7b_1638275152145/3 on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0002: started saving index to file:/tmp/7b995c85-d504-4fbf-b2de-1414803eb410/BruteForceSimilarity_41dab0fe9291f3bcca7b_1638275152145/2 on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0002: finished saving index to file:/tmp/7b995c85-d504-4fbf-b2de-1414803eb410/BruteForceSimilarity_41dab0fe9291f3bcca7b_1638275152145/2 on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0000: finished saving index to file:/tmp/7b995c85-d504-4fbf-b2de-1414803eb410/BruteForceSimilarity_41dab0fe9291f3bcca7b_1638275152145/0 on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  Executor:54 - Finished task 2.0 in stage 1.0 (TID 6). 1985 bytes result sent to driver
2021-11-30 20:26:01 INFO  Executor:54 - Finished task 0.0 in stage 1.0 (TID 4). 1985 bytes result sent to driver
2021-11-30 20:26:01 INFO  TaskSetManager:54 - Finished task 2.0 in stage 1.0 (TID 6) in 2092 ms on localhost (executor driver) (1/4)
2021-11-30 20:26:01 INFO  TaskSetManager:54 - Finished task 0.0 in stage 1.0 (TID 4) in 2093 ms on localhost (executor driver) (2/4)
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0003: finished saving index to file:/tmp/7b995c85-d504-4fbf-b2de-1414803eb410/BruteForceSimilarity_41dab0fe9291f3bcca7b_1638275152145/3 on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  Executor:54 - Finished task 3.0 in stage 1.0 (TID 7). 1942 bytes result sent to driver
2021-11-30 20:26:01 INFO  BruteForceSimilarity:54 - partition 0001: finished saving index to file:/tmp/7b995c85-d504-4fbf-b2de-1414803eb410/BruteForceSimilarity_41dab0fe9291f3bcca7b_1638275152145/1 on host LAPTOP-K1RS47MN
2021-11-30 20:26:01 INFO  TaskSetManager:54 - Finished task 3.0 in stage 1.0 (TID 7) in 2095 ms on localhost (executor driver) (3/4)
2021-11-30 20:26:01 INFO  Executor:54 - Finished task 1.0 in stage 1.0 (TID 5). 1985 bytes result sent to driver
2021-11-30 20:26:01 INFO  TaskSetManager:54 - Finished task 1.0 in stage 1.0 (TID 5) in 2098 ms on localhost (executor driver) (4/4)
2021-11-30 20:26:01 INFO  TaskSchedulerImpl:54 - Removed TaskSet 1.0, whose tasks have all completed, from pool 
2021-11-30 20:26:01 INFO  DAGScheduler:54 - ResultStage 1 (foreachPartition at KnnAlgorithm.scala:846) finished in 2.126 s
2021-11-30 20:26:01 INFO  DAGScheduler:54 - Job 0 finished: foreachPartition at KnnAlgorithm.scala:846, took 8.412499 s
2021-11-30 20:26:02 INFO  CleanupListener:54 - Deleting files below file:/tmp/7b995c85-d504-4fbf-b2de-1414803eb410/BruteForceSimilarity_41dab0fe9291f3bcca7b_1638275152145
2021-11-30 20:26:02 INFO  AbstractConnector:318 - Stopped Spark@6107ded7{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2021-11-30 20:26:02 INFO  SparkUI:54 - Stopped Spark web UI at http://10.162.40.121:4040
2021-11-30 20:26:02 INFO  MapOutputTrackerMasterEndpoint:54 - MapOutputTrackerMasterEndpoint stopped!
2021-11-30 20:26:02 INFO  MemoryStore:54 - MemoryStore cleared
2021-11-30 20:26:02 INFO  BlockManager:54 - BlockManager stopped
2021-11-30 20:26:02 INFO  BlockManagerMaster:54 - BlockManagerMaster stopped
2021-11-30 20:26:02 INFO  OutputCommitCoordinator$OutputCommitCoordinatorEndpoint:54 - OutputCommitCoordinator stopped!
2021-11-30 20:26:02 INFO  SparkContext:54 - Successfully stopped SparkContext
bruteForce timeUsed
 367.6133155822754
2021-11-30 20:26:02 INFO  SparkContext:54 - Running Spark version 2.3.0
2021-11-30 20:26:02 INFO  SparkContext:54 - Submitted application: mytest
2021-11-30 20:26:02 INFO  SecurityManager:54 - Changing view acls to: yaoheng
2021-11-30 20:26:02 INFO  SecurityManager:54 - Changing modify acls to: yaoheng
2021-11-30 20:26:02 INFO  SecurityManager:54 - Changing view acls groups to: 
2021-11-30 20:26:02 INFO  SecurityManager:54 - Changing modify acls groups to: 
2021-11-30 20:26:02 INFO  SecurityManager:54 - SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(yaoheng); groups with view permissions: Set(); users  with modify permissions: Set(yaoheng); groups with modify permissions: Set()
2021-11-30 20:26:02 INFO  Utils:54 - Successfully started service 'sparkDriver' on port 59723.
2021-11-30 20:26:02 INFO  SparkEnv:54 - Registering MapOutputTracker
2021-11-30 20:26:02 INFO  SparkEnv:54 - Registering BlockManagerMaster
2021-11-30 20:26:02 INFO  BlockManagerMasterEndpoint:54 - Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2021-11-30 20:26:02 INFO  BlockManagerMasterEndpoint:54 - BlockManagerMasterEndpoint up
2021-11-30 20:26:02 INFO  DiskBlockManager:54 - Created local directory at /tmp/blockmgr-b64fa5fc-bcbd-480c-be9f-e5e96d3c5490
2021-11-30 20:26:02 INFO  MemoryStore:54 - MemoryStore started with capacity 2.5 GB
2021-11-30 20:26:02 INFO  SparkEnv:54 - Registering OutputCommitCoordinator
2021-11-30 20:26:02 INFO  Server:346 - jetty-9.3.z-SNAPSHOT
2021-11-30 20:26:02 INFO  Server:414 - Started @42787ms
2021-11-30 20:26:02 INFO  AbstractConnector:278 - Started ServerConnector@547ba21b{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2021-11-30 20:26:02 INFO  Utils:54 - Successfully started service 'SparkUI' on port 4040.
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@36968926{/jobs,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5a3599b5{/jobs/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3310218c{/jobs/job,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3af2268f{/jobs/job/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@38af474e{/stages,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4ea199df{/stages/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7c8fcdc6{/stages/stage,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@57e25a86{/stages/stage/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@15b5e203{/stages/pool,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5798ee0b{/stages/pool/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@557bf8c3{/storage,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1088ae80{/storage/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2a97e368{/storage/rdd,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3aefb887{/storage/rdd/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@30d8f2f9{/environment,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@65f1a6cc{/environment/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@70e895b9{/executors,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@370430a3{/executors/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@40bc5380{/executors/threadDump,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@28135a9d{/executors/threadDump/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1c62477b{/static,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@a75ed7c{/,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@28f78fe1{/api,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@14d52a64{/jobs/job/kill,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@31ee2b8f{/stages/stage/kill,null,AVAILABLE,@Spark}
2021-11-30 20:26:02 INFO  SparkUI:54 - Bound SparkUI to 0.0.0.0, and started at http://10.162.40.121:4040
2021-11-30 20:26:02 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar at spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638275162828
2021-11-30 20:26:02 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar at spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638275162828
2021-11-30 20:26:02 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar at spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638275162828
2021-11-30 20:26:02 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar at spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638275162828
2021-11-30 20:26:02 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at spark://10.162.40.121:59723/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638275162828
2021-11-30 20:26:02 INFO  SparkContext:54 - Added JAR file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at spark://10.162.40.121:59723/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638275162829
2021-11-30 20:26:02 INFO  SparkContext:54 - Added file file:/home/yaoheng/test/spark-aknn/test/test.py at file:/home/yaoheng/test/spark-aknn/test/test.py with timestamp 1638275162829
2021-11-30 20:26:02 INFO  Utils:54 - Copying /home/yaoheng/test/spark-aknn/test/test.py to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/test.py
2021-11-30 20:26:02 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638275162840
2021-11-30 20:26:02 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 20:26:02 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638275162853
2021-11-30 20:26:02 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 20:26:02 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638275162864
2021-11-30 20:26:02 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 20:26:02 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar at file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638275162875
2021-11-30 20:26:02 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 20:26:02 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar at file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638275162886
2021-11-30 20:26:02 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 20:26:02 INFO  SparkContext:54 - Added file file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar at file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638275162916
2021-11-30 20:26:02 INFO  Utils:54 - Copying /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 20:26:02 INFO  Executor:54 - Starting executor ID driver on host localhost
2021-11-30 20:26:02 INFO  Utils:54 - Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 59724.
2021-11-30 20:26:02 INFO  NettyBlockTransferService:54 - Server created on 10.162.40.121:59724
2021-11-30 20:26:02 INFO  BlockManager:54 - Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2021-11-30 20:26:02 INFO  BlockManagerMaster:54 - Registering BlockManager BlockManagerId(driver, 10.162.40.121, 59724, None)
2021-11-30 20:26:02 INFO  BlockManagerMasterEndpoint:54 - Registering block manager 10.162.40.121:59724 with 2.5 GB RAM, BlockManagerId(driver, 10.162.40.121, 59724, None)
2021-11-30 20:26:02 INFO  BlockManagerMaster:54 - Registered BlockManager BlockManagerId(driver, 10.162.40.121, 59724, None)
2021-11-30 20:26:02 INFO  BlockManager:54 - Initialized BlockManager: BlockManagerId(driver, 10.162.40.121, 59724, None)
2021-11-30 20:26:02 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@685f33f0{/metrics/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:07 INFO  SharedState:54 - Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/home/yaoheng/test/spark-aknn/spark-warehouse/').
2021-11-30 20:26:07 INFO  SharedState:54 - Warehouse path is 'file:/home/yaoheng/test/spark-aknn/spark-warehouse/'.
2021-11-30 20:26:07 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@25a18bc1{/SQL,null,AVAILABLE,@Spark}
2021-11-30 20:26:07 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@25563f18{/SQL/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:07 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@264cd26{/SQL/execution,null,AVAILABLE,@Spark}
2021-11-30 20:26:07 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2592b17b{/SQL/execution/json,null,AVAILABLE,@Spark}
2021-11-30 20:26:07 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1baaa10b{/static/sql,null,AVAILABLE,@Spark}
2021-11-30 20:26:07 INFO  StateStoreCoordinatorRef:54 - Registered StateStoreCoordinator endpoint
2021-11-30 20:26:26 INFO  SparkContext:54 - Starting job: foreachPartition at KnnAlgorithm.scala:846
2021-11-30 20:26:26 INFO  DAGScheduler:54 - Registering RDD 17 (foreachPartition at KnnAlgorithm.scala:846)
2021-11-30 20:26:26 INFO  DAGScheduler:54 - Got job 0 (foreachPartition at KnnAlgorithm.scala:846) with 4 output partitions
2021-11-30 20:26:26 INFO  DAGScheduler:54 - Final stage: ResultStage 1 (foreachPartition at KnnAlgorithm.scala:846)
2021-11-30 20:26:26 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 0)
2021-11-30 20:26:26 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 0)
2021-11-30 20:26:26 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 0 (MapPartitionsRDD[17] at foreachPartition at KnnAlgorithm.scala:846), which has no missing parents
2021-11-30 20:26:26 INFO  MemoryStore:54 - Block broadcast_0 stored as values in memory (estimated size 14.1 KB, free 2.5 GB)
2021-11-30 20:26:26 INFO  MemoryStore:54 - Block broadcast_0_piece0 stored as bytes in memory (estimated size 7.2 KB, free 2.5 GB)
2021-11-30 20:26:26 INFO  BlockManagerInfo:54 - Added broadcast_0_piece0 in memory on 10.162.40.121:59724 (size: 7.2 KB, free: 2.5 GB)
2021-11-30 20:26:26 INFO  SparkContext:54 - Created broadcast 0 from broadcast at DAGScheduler.scala:1039
2021-11-30 20:26:26 INFO  DAGScheduler:54 - Submitting 4 missing tasks from ShuffleMapStage 0 (MapPartitionsRDD[17] at foreachPartition at KnnAlgorithm.scala:846) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
2021-11-30 20:26:26 INFO  TaskSchedulerImpl:54 - Adding task set 0.0 with 4 tasks
2021-11-30 20:26:26 WARN  TaskSetManager:66 - Stage 0 contains a task of very large size (113395 KB). The maximum recommended task size is 100 KB.
2021-11-30 20:26:26 INFO  TaskSetManager:54 - Starting task 0.0 in stage 0.0 (TID 0, localhost, executor driver, partition 0, PROCESS_LOCAL, 116117323 bytes)
2021-11-30 20:26:26 INFO  ContextCleaner:54 - Cleaned accumulator 58
2021-11-30 20:26:26 INFO  TaskSetManager:54 - Starting task 1.0 in stage 0.0 (TID 1, localhost, executor driver, partition 1, PROCESS_LOCAL, 117447010 bytes)
2021-11-30 20:26:26 INFO  TaskSetManager:54 - Starting task 2.0 in stage 0.0 (TID 2, localhost, executor driver, partition 2, PROCESS_LOCAL, 117447010 bytes)
2021-11-30 20:26:27 INFO  TaskSetManager:54 - Starting task 3.0 in stage 0.0 (TID 3, localhost, executor driver, partition 3, PROCESS_LOCAL, 116997344 bytes)
2021-11-30 20:26:27 INFO  Executor:54 - Running task 0.0 in stage 0.0 (TID 0)
2021-11-30 20:26:27 INFO  Executor:54 - Running task 1.0 in stage 0.0 (TID 1)
2021-11-30 20:26:27 INFO  Executor:54 - Fetching file:/home/yaoheng/test/spark-aknn/test/test.py with timestamp 1638275162829
2021-11-30 20:26:27 INFO  Executor:54 - Running task 2.0 in stage 0.0 (TID 2)
2021-11-30 20:26:27 INFO  Executor:54 - Running task 3.0 in stage 0.0 (TID 3)
2021-11-30 20:26:27 INFO  Utils:54 - /home/yaoheng/test/spark-aknn/test/test.py has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/test.py
2021-11-30 20:26:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638275162886
2021-11-30 20:26:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 20:26:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638275162840
2021-11-30 20:26:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 20:26:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638275162864
2021-11-30 20:26:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 20:26:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638275162875
2021-11-30 20:26:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 20:26:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638275162853
2021-11-30 20:26:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 20:26:27 INFO  Executor:54 - Fetching file:///home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638275162916
2021-11-30 20:26:27 INFO  Utils:54 - /home/yaoheng/.ivy2/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 20:26:27 INFO  Executor:54 - Fetching spark://10.162.40.121:59723/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar with timestamp 1638275162829
2021-11-30 20:26:27 INFO  TransportClientFactory:267 - Successfully created connection to /10.162.40.121:59723 after 1 ms (0 ms spent in bootstraps)
2021-11-30 20:26:27 INFO  Utils:54 - Fetching spark://10.162.40.121:59723/jars/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp3747339303044323516.tmp
2021-11-30 20:26:27 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp3747339303044323516.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/org.eclipse.collections_eclipse-collections-api-9.2.0.jar
2021-11-30 20:26:27 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/org.eclipse.collections_eclipse-collections-api-9.2.0.jar to class loader
2021-11-30 20:26:27 INFO  Executor:54 - Fetching spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar with timestamp 1638275162828
2021-11-30 20:26:27 INFO  Utils:54 - Fetching spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp4392038958355814668.tmp
2021-11-30 20:26:27 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp4392038958355814668.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar
2021-11-30 20:26:27 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-scala_2.11-0.0.49.jar to class loader
2021-11-30 20:26:27 INFO  Executor:54 - Fetching spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar with timestamp 1638275162828
2021-11-30 20:26:27 INFO  Utils:54 - Fetching spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp2504350723188943172.tmp
2021-11-30 20:26:27 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp2504350723188943172.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar
2021-11-30 20:26:27 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-spark_2.3_2.11-0.0.49.jar to class loader
2021-11-30 20:26:27 INFO  Executor:54 - Fetching spark://10.162.40.121:59723/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar with timestamp 1638275162828
2021-11-30 20:26:27 INFO  Utils:54 - Fetching spark://10.162.40.121:59723/jars/org.eclipse.collections_eclipse-collections-9.2.0.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp3005428928918427424.tmp
2021-11-30 20:26:27 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp3005428928918427424.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/org.eclipse.collections_eclipse-collections-9.2.0.jar
2021-11-30 20:26:27 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/org.eclipse.collections_eclipse-collections-9.2.0.jar to class loader
2021-11-30 20:26:27 INFO  Executor:54 - Fetching spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar with timestamp 1638275162828
2021-11-30 20:26:27 INFO  Utils:54 - Fetching spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-utils-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp289729967931379315.tmp
2021-11-30 20:26:27 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp289729967931379315.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-utils-0.0.49.jar
2021-11-30 20:26:27 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-utils-0.0.49.jar to class loader
2021-11-30 20:26:27 INFO  Executor:54 - Fetching spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar with timestamp 1638275162828
2021-11-30 20:26:27 INFO  Utils:54 - Fetching spark://10.162.40.121:59723/jars/com.github.jelmerk_hnswlib-core-0.0.49.jar to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp8724874311500212610.tmp
2021-11-30 20:26:27 INFO  Utils:54 - /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/fetchFileTemp8724874311500212610.tmp has been previously copied to /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-core-0.0.49.jar
2021-11-30 20:26:27 INFO  Executor:54 - Adding file:/tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/userFiles-593e6a33-4ab1-461b-b381-9c5183d1a15a/com.github.jelmerk_hnswlib-core-0.0.49.jar to class loader
2021-11-30 20:26:31 INFO  PythonRunner:54 - Times: total = 3718, boot = 485, init = 2, finish = 3231
2021-11-30 20:26:31 INFO  PythonRunner:54 - Times: total = 3757, boot = 494, init = 2, finish = 3261
2021-11-30 20:26:31 INFO  PythonRunner:54 - Times: total = 3809, boot = 505, init = 3, finish = 3301
2021-11-30 20:26:31 INFO  PythonRunner:54 - Times: total = 3819, boot = 517, init = 3, finish = 3299
2021-11-30 20:26:31 INFO  Executor:54 - Finished task 0.0 in stage 0.0 (TID 0). 1918 bytes result sent to driver
2021-11-30 20:26:31 INFO  TaskSetManager:54 - Finished task 0.0 in stage 0.0 (TID 0) in 4999 ms on localhost (executor driver) (1/4)
2021-11-30 20:26:31 INFO  Executor:54 - Finished task 3.0 in stage 0.0 (TID 3). 1918 bytes result sent to driver
2021-11-30 20:26:31 INFO  TaskSetManager:54 - Finished task 3.0 in stage 0.0 (TID 3) in 4490 ms on localhost (executor driver) (2/4)
2021-11-30 20:26:31 INFO  Executor:54 - Finished task 1.0 in stage 0.0 (TID 1). 1918 bytes result sent to driver
2021-11-30 20:26:31 INFO  TaskSetManager:54 - Finished task 1.0 in stage 0.0 (TID 1) in 5031 ms on localhost (executor driver) (3/4)
2021-11-30 20:26:31 INFO  Executor:54 - Finished task 2.0 in stage 0.0 (TID 2). 1918 bytes result sent to driver
2021-11-30 20:26:31 INFO  TaskSetManager:54 - Finished task 2.0 in stage 0.0 (TID 2) in 4630 ms on localhost (executor driver) (4/4)
2021-11-30 20:26:31 INFO  TaskSchedulerImpl:54 - Removed TaskSet 0.0, whose tasks have all completed, from pool 
2021-11-30 20:26:31 INFO  DAGScheduler:54 - ShuffleMapStage 0 (foreachPartition at KnnAlgorithm.scala:846) finished in 5.102 s
2021-11-30 20:26:31 INFO  DAGScheduler:54 - looking for newly runnable stages
2021-11-30 20:26:31 INFO  DAGScheduler:54 - running: Set()
2021-11-30 20:26:31 INFO  DAGScheduler:54 - waiting: Set(ResultStage 1)
2021-11-30 20:26:31 INFO  DAGScheduler:54 - failed: Set()
2021-11-30 20:26:31 INFO  DAGScheduler:54 - Submitting ResultStage 1 (MapPartitionsRDD[20] at foreachPartition at KnnAlgorithm.scala:846), which has no missing parents
2021-11-30 20:26:31 INFO  MemoryStore:54 - Block broadcast_1 stored as values in memory (estimated size 85.9 KB, free 2.5 GB)
2021-11-30 20:26:31 INFO  MemoryStore:54 - Block broadcast_1_piece0 stored as bytes in memory (estimated size 33.2 KB, free 2.5 GB)
2021-11-30 20:26:31 INFO  BlockManagerInfo:54 - Added broadcast_1_piece0 in memory on 10.162.40.121:59724 (size: 33.2 KB, free: 2.5 GB)
2021-11-30 20:26:31 INFO  SparkContext:54 - Created broadcast 1 from broadcast at DAGScheduler.scala:1039
2021-11-30 20:26:31 INFO  DAGScheduler:54 - Submitting 4 missing tasks from ResultStage 1 (MapPartitionsRDD[20] at foreachPartition at KnnAlgorithm.scala:846) (first 15 tasks are for partitions Vector(0, 1, 2, 3))
2021-11-30 20:26:31 INFO  TaskSchedulerImpl:54 - Adding task set 1.0 with 4 tasks
2021-11-30 20:26:31 INFO  TaskSetManager:54 - Starting task 0.0 in stage 1.0 (TID 4, localhost, executor driver, partition 0, ANY, 7754 bytes)
2021-11-30 20:26:31 INFO  TaskSetManager:54 - Starting task 1.0 in stage 1.0 (TID 5, localhost, executor driver, partition 1, ANY, 7754 bytes)
2021-11-30 20:26:31 INFO  TaskSetManager:54 - Starting task 2.0 in stage 1.0 (TID 6, localhost, executor driver, partition 2, ANY, 7754 bytes)
2021-11-30 20:26:31 INFO  TaskSetManager:54 - Starting task 3.0 in stage 1.0 (TID 7, localhost, executor driver, partition 3, ANY, 7754 bytes)
2021-11-30 20:26:31 INFO  Executor:54 - Running task 3.0 in stage 1.0 (TID 7)
2021-11-30 20:26:31 INFO  Executor:54 - Running task 0.0 in stage 1.0 (TID 4)
2021-11-30 20:26:31 INFO  Executor:54 - Running task 2.0 in stage 1.0 (TID 6)
2021-11-30 20:26:31 INFO  Executor:54 - Running task 1.0 in stage 1.0 (TID 5)
2021-11-30 20:26:31 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 20:26:31 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 20:26:31 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 20:26:31 INFO  ShuffleBlockFetcherIterator:54 - Getting 4 non-empty blocks out of 4 blocks
2021-11-30 20:26:31 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2021-11-30 20:26:31 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2021-11-30 20:26:31 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2021-11-30 20:26:31 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2021-11-30 20:26:31 INFO  CodeGenerator:54 - Code generated in 30.6568 ms
2021-11-30 20:26:32 INFO  HnswSimilarity:54 - partition 0002: started indexing 100307 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:32 INFO  HnswSimilarity:54 - partition 0001: started indexing 99769 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:32 INFO  HnswSimilarity:54 - partition 0000: started indexing 99810 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:32 INFO  HnswSimilarity:54 - partition 0003: started indexing 100114 items on host LAPTOP-K1RS47MN
2021-11-30 20:26:34 INFO  BlockManagerInfo:54 - Removed broadcast_0_piece0 on 10.162.40.121:59724 in memory (size: 7.2 KB, free: 2.5 GB)
2021-11-30 20:27:31 INFO  HnswSimilarity:54 - partition 0002: finished indexing 100307 items on host LAPTOP-K1RS47MN
2021-11-30 20:27:31 INFO  HnswSimilarity:54 - partition 0002: started saving index to file:/tmp/838caa08-6c47-454d-be63-6ce349c6a3e5/HnswSimilarity_48929ed471f2b05d7052_1638275186328/2 on host LAPTOP-K1RS47MN
2021-11-30 20:27:34 INFO  HnswSimilarity:54 - partition 0000: finished indexing 99810 items on host LAPTOP-K1RS47MN
2021-11-30 20:27:34 INFO  HnswSimilarity:54 - partition 0002: finished saving index to file:/tmp/838caa08-6c47-454d-be63-6ce349c6a3e5/HnswSimilarity_48929ed471f2b05d7052_1638275186328/2 on host LAPTOP-K1RS47MN
2021-11-30 20:27:34 INFO  Executor:54 - Finished task 2.0 in stage 1.0 (TID 6). 1942 bytes result sent to driver
2021-11-30 20:27:34 INFO  TaskSetManager:54 - Finished task 2.0 in stage 1.0 (TID 6) in 63029 ms on localhost (executor driver) (1/4)
2021-11-30 20:27:34 INFO  HnswSimilarity:54 - partition 0000: started saving index to file:/tmp/838caa08-6c47-454d-be63-6ce349c6a3e5/HnswSimilarity_48929ed471f2b05d7052_1638275186328/0 on host LAPTOP-K1RS47MN
2021-11-30 20:27:34 INFO  HnswSimilarity:54 - partition 0003: finished indexing 100114 items on host LAPTOP-K1RS47MN
2021-11-30 20:27:34 INFO  HnswSimilarity:54 - partition 0003: started saving index to file:/tmp/838caa08-6c47-454d-be63-6ce349c6a3e5/HnswSimilarity_48929ed471f2b05d7052_1638275186328/3 on host LAPTOP-K1RS47MN
2021-11-30 20:27:34 INFO  HnswSimilarity:54 - partition 0001: finished indexing 99769 items on host LAPTOP-K1RS47MN
2021-11-30 20:27:34 INFO  HnswSimilarity:54 - partition 0001: started saving index to file:/tmp/838caa08-6c47-454d-be63-6ce349c6a3e5/HnswSimilarity_48929ed471f2b05d7052_1638275186328/1 on host LAPTOP-K1RS47MN
2021-11-30 20:27:35 INFO  HnswSimilarity:54 - partition 0000: finished saving index to file:/tmp/838caa08-6c47-454d-be63-6ce349c6a3e5/HnswSimilarity_48929ed471f2b05d7052_1638275186328/0 on host LAPTOP-K1RS47MN
2021-11-30 20:27:35 INFO  Executor:54 - Finished task 0.0 in stage 1.0 (TID 4). 1899 bytes result sent to driver
2021-11-30 20:27:35 INFO  TaskSetManager:54 - Finished task 0.0 in stage 1.0 (TID 4) in 63617 ms on localhost (executor driver) (2/4)
2021-11-30 20:27:35 INFO  HnswSimilarity:54 - partition 0003: finished saving index to file:/tmp/838caa08-6c47-454d-be63-6ce349c6a3e5/HnswSimilarity_48929ed471f2b05d7052_1638275186328/3 on host LAPTOP-K1RS47MN
2021-11-30 20:27:35 INFO  Executor:54 - Finished task 3.0 in stage 1.0 (TID 7). 1899 bytes result sent to driver
2021-11-30 20:27:35 INFO  TaskSetManager:54 - Finished task 3.0 in stage 1.0 (TID 7) in 63686 ms on localhost (executor driver) (3/4)
2021-11-30 20:27:35 INFO  HnswSimilarity:54 - partition 0001: finished saving index to file:/tmp/838caa08-6c47-454d-be63-6ce349c6a3e5/HnswSimilarity_48929ed471f2b05d7052_1638275186328/1 on host LAPTOP-K1RS47MN
2021-11-30 20:27:35 INFO  Executor:54 - Finished task 1.0 in stage 1.0 (TID 5). 1899 bytes result sent to driver
2021-11-30 20:27:35 INFO  TaskSetManager:54 - Finished task 1.0 in stage 1.0 (TID 5) in 63734 ms on localhost (executor driver) (4/4)
2021-11-30 20:27:35 INFO  TaskSchedulerImpl:54 - Removed TaskSet 1.0, whose tasks have all completed, from pool 
2021-11-30 20:27:35 INFO  DAGScheduler:54 - ResultStage 1 (foreachPartition at KnnAlgorithm.scala:846) finished in 63.749 s
2021-11-30 20:27:35 INFO  DAGScheduler:54 - Job 0 finished: foreachPartition at KnnAlgorithm.scala:846, took 68.857958 s
2021-11-30 20:27:35 INFO  CleanupListener:54 - Deleting files below file:/tmp/838caa08-6c47-454d-be63-6ce349c6a3e5/HnswSimilarity_48929ed471f2b05d7052_1638275186328
2021-11-30 20:27:35 INFO  AbstractConnector:318 - Stopped Spark@547ba21b{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2021-11-30 20:27:35 INFO  SparkUI:54 - Stopped Spark web UI at http://10.162.40.121:4040
2021-11-30 20:27:35 INFO  MapOutputTrackerMasterEndpoint:54 - MapOutputTrackerMasterEndpoint stopped!
2021-11-30 20:27:35 INFO  MemoryStore:54 - MemoryStore cleared
2021-11-30 20:27:35 INFO  BlockManager:54 - BlockManager stopped
2021-11-30 20:27:35 INFO  BlockManagerMaster:54 - BlockManagerMaster stopped
2021-11-30 20:27:35 INFO  OutputCommitCoordinator$OutputCommitCoordinatorEndpoint:54 - OutputCommitCoordinator stopped!
2021-11-30 20:27:35 INFO  SparkContext:54 - Successfully stopped SparkContext
testmain_naiveSparkHnsw timeUsed
 197.59488105773926
2021-11-30 20:27:36 INFO  ShutdownHookManager:54 - Shutdown hook called
2021-11-30 20:27:36 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-adacc223-5093-4857-a68c-2ce277041b69
2021-11-30 20:27:36 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c
2021-11-30 20:27:36 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/pyspark-494d72c9-7886-494a-a98c-21601099aa83
2021-11-30 20:27:36 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-a111d64a-83df-49e0-ba86-38892126ec8c/pyspark-49a65d5c-0378-4934-b4b7-a16ac4d7cd84
maxelement = 100000000
k=10
partitionnum=4
ef = int(1.5*k)
sc = 1
m = int(30)
distanceFunction='euclidean'

