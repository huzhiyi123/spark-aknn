topkPartitionNumlist cmp 1
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 52171   l 10000 k 10
recall: 0.52171
totalconstructtime 314545.9895133972 kmeanspartitiontime 144094.44499015808 localindexconstructtime 167609.62414741516 globalindexconstructtime 2841.9203758239746
totalsearchtime 24488.616704940796 localsearchtime 24327.871322631836 globalsearchtime 160.74538230895996
hello world testdoublekmeansHnsw

topkPartitionNumlist cmp 2
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 82014   l 10000 k 10
recall: 0.82014
totalconstructtime 309122.154712677 kmeanspartitiontime 142143.60117912292 localindexconstructtime 164200.3448009491 globalindexconstructtime 2778.2087326049805
totalsearchtime 24854.13384437561 localsearchtime 24699.458599090576 globalsearchtime 154.67524528503418
hello world testdoublekmeansHnsw

topkPartitionNumlist cmp 3
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 95288   l 10000 k 10
recall: 0.95288
totalconstructtime 306628.53932380676 kmeanspartitiontime 141683.48670005798 localindexconstructtime 162081.77065849304 globalindexconstructtime 2863.2819652557373
totalsearchtime 27025.248527526855 localsearchtime 26863.54684829712 globalsearchtime 161.70167922973633
hello world testdoublekmeansHnsw

topkPartitionNumlist cmp 4
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 96908   l 10000 k 10
recall: 0.96908
totalconstructtime 308306.43939971924 kmeanspartitiontime 141261.1494064331 localindexconstructtime 164246.6962337494 globalindexconstructtime 2798.593759536743
totalsearchtime 29588.700771331787 localsearchtime 29433.289527893066 globalsearchtime 155.4112434387207
hello world testdoublekmeansHnsw

topkPartitionNumlist cmp 5
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 97168   l 10000 k 10
recall: 0.97168
totalconstructtime 307068.3283805847 kmeanspartitiontime 140613.5048866272 localindexconstructtime 163638.6616230011 globalindexconstructtime 2816.161870956421
totalsearchtime 30936.42020225525 localsearchtime 30776.6432762146 globalsearchtime 159.7769260406494
hello world testdoublekmeansHnsw

topkPartitionNumlist cmp 6
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 97202   l 10000 k 10
recall: 0.97202
totalconstructtime 317628.91960144043 kmeanspartitiontime 148322.7822780609 localindexconstructtime 166526.6330242157 globalindexconstructtime 2779.5042991638184
totalsearchtime 32046.49543762207 localsearchtime 31888.35310935974 globalsearchtime 158.1423282623291
hello world testdoublekmeansHnsw

topkPartitionNumlist cmp 7
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 97261   l 10000 k 10
recall: 0.97261
totalconstructtime 305484.4491481781 kmeanspartitiontime 141752.4254322052 localindexconstructtime 160915.86327552795 globalindexconstructtime 2816.1604404449463
totalsearchtime 33654.44564819336 localsearchtime 33496.21868133545 globalsearchtime 158.22696685791016
hello world testdoublekmeansHnsw

topkPartitionNumlist cmp 8
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 97304   l 10000 k 10
recall: 0.97304
totalconstructtime 310902.272939682 kmeanspartitiontime 142487.97369003296 localindexconstructtime 165636.40141487122 globalindexconstructtime 2777.897834777832
totalsearchtime 33952.60190963745 localsearchtime 33793.91145706177 globalsearchtime 158.6904525756836
hello world testdoublekmeansHnsw

end topkPartitionNumlist cmp
 8
maxelement = 100000000
k=10
partitionnum=8
topkPartitionNum=3

sc = 1
m = int(50)
distanceFunction='cosine'
kmeanstrainrate=0.05

efConstruction=35
ef = int(4*22)
"""
datapath="/my/siftsmall/"
traindatapath=datapath+"siftsmall_base.fvecs"
querydatapath=datapath+"siftsmall_query.fvecs"
querygroundtruthpath=datapath+"siftsmall_groundtruth.ivecs"
"""
datapath="/my/sift/"
traindatapath=datapath+"sift_base.fvecs"
querydatapath=datapath+"sift_query.fvecs"
querygroundtruthpath=datapath+"sift_groundtruth.ivecs"

# ef=10, efConstruction=200


def initparams():
    global maxelement,k,partitionnum,topkPartitionNum,ef,m,distanceFunction,kmeanstrainraten,efConstruction
    maxelement = 100000000
    k=10
    partitionnum=8
    topkPartitionNum=5
    
    sc = 1
    m = int(50)
    distanceFunction='cosine'
    kmeanstrainrate=0.05
    efConstruction=85
    ef = efConstruction
recall = cnt/float(l*k) 52171   l 10000 k 10
recall: 0.52171
recall = cnt/float(l*k) 82014   l 10000 k 10
recall: 0.82014
recall = cnt/float(l*k) 95288   l 10000 k 10
recall: 0.95288
recall = cnt/float(l*k) 96908   l 10000 k 10
recall: 0.96908
recall = cnt/float(l*k) 97168   l 10000 k 10
recall: 0.97168
recall = cnt/float(l*k) 97202   l 10000 k 10
recall: 0.97202
recall = cnt/float(l*k) 97261   l 10000 k 10
recall: 0.97261
recall = cnt/float(l*k) 97304   l 10000 k 10
recall: 0.97304
