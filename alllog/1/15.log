for i in efConstructionlist:
efConstruction cmp 12
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 76178   l 10000 k 10
recall: 0.76178
totalconstructtime 308951.3900279999 kmeanspartitiontime 140487.3538017273 localindexconstructtime 165620.70989608765 globalindexconstructtime 2843.3263301849365
totalsearchtime 22401.075839996338 localsearchtime 22243.82185935974 globalsearchtime 157.25398063659668
hello world testdoublekmeansHnsw

efConstruction cmp 30
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 88775   l 10000 k 10
recall: 0.88775
totalconstructtime 314293.8027381897 kmeanspartitiontime 148237.98608779907 localindexconstructtime 163272.84693717957 globalindexconstructtime 2782.9697132110596
totalsearchtime 23148.614645004272 localsearchtime 22990.606784820557 globalsearchtime 158.00786018371582
hello world testdoublekmeansHnsw

efConstruction cmp 80
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 95711   l 10000 k 10
recall: 0.95711
totalconstructtime 393006.2494277954 kmeanspartitiontime 139611.98139190674 localindexconstructtime 250616.6422367096 globalindexconstructtime 2777.625799179077
totalsearchtime 27356.200456619263 localsearchtime 27196.568727493286 globalsearchtime 159.63172912597656
hello world testdoublekmeansHnsw

efConstruction cmp 120
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 96561   l 10000 k 10
recall: 0.96561
totalconstructtime 510802.5133609772 kmeanspartitiontime 140639.37163352966 localindexconstructtime 367336.81297302246 globalindexconstructtime 2826.328754425049
totalsearchtime 31596.662282943726 localsearchtime 31434.92817878723 globalsearchtime 161.73410415649414
hello world testdoublekmeansHnsw

efConstruction cmp 180
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 96829   l 10000 k 10
recall: 0.96829
totalconstructtime 676280.2021503448 kmeanspartitiontime 139637.4216079712 localindexconstructtime 533833.5711956024 globalindexconstructtime 2809.2093467712402
totalsearchtime 38575.59251785278 localsearchtime 38419.69656944275 globalsearchtime 155.89594841003418
hello world testdoublekmeansHnsw

efConstruction cmp 200
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 97018   l 10000 k 10
recall: 0.97018
totalconstructtime 710238.4462356567 kmeanspartitiontime 139204.1516304016 localindexconstructtime 568205.5752277374 globalindexconstructtime 2828.7193775177
totalsearchtime 40927.48022079468 localsearchtime 40768.112897872925 globalsearchtime 159.36732292175293
hello world testdoublekmeansHnsw

efConstruction cmp 250
/my/spark-aknn/test/testdoublekmeans.py
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 97184   l 10000 k 10
recall: 0.97184
totalconstructtime 848340.8875465393 kmeanspartitiontime 140702.61907577515 localindexconstructtime 704856.5320968628 globalindexconstructtime 2781.736373901367
totalsearchtime 45826.54404640198 localsearchtime 45668.31159591675 globalsearchtime 158.2324504852295
hello world testdoublekmeansHnsw

end efConstructionlist
 [12, 30, 80, 120, 180, 200, 250]
maxelement = 100000000
k=10
partitionnum=8
topkPartitionNum=3

sc = 1
m = int(50)
distanceFunction='cosine'
kmeanstrainrate=0.05

efConstruction=35
ef = int(4*22)
"""
datapath="/my/siftsmall/"
traindatapath=datapath+"siftsmall_base.fvecs"
querydatapath=datapath+"siftsmall_query.fvecs"
querygroundtruthpath=datapath+"siftsmall_groundtruth.ivecs"
"""
datapath="/my/sift/"
traindatapath=datapath+"sift_base.fvecs"
querydatapath=datapath+"sift_query.fvecs"
querygroundtruthpath=datapath+"sift_groundtruth.ivecs"

# ef=10, efConstruction=200


def initparams():
    global maxelement,k,partitionnum,topkPartitionNum,ef,m,distanceFunction,kmeanstrainraten,efConstruction
    maxelement = 100000000
    k=10
    partitionnum=8
    topkPartitionNum=5
    
    sc = 1
    m = int(50)
    distanceFunction='cosine'
    kmeanstrainrate=0.05
    efConstruction=50
    ef = efConstruction
[12,30,80,120,180,200,250]
recall = cnt/float(l*k) 76178   l 10000 k 10
recall: 0.76178
recall = cnt/float(l*k) 88775   l 10000 k 10
recall: 0.88775
recall = cnt/float(l*k) 95711   l 10000 k 10
recall: 0.95711
recall = cnt/float(l*k) 96561   l 10000 k 10
recall: 0.96561
recall = cnt/float(l*k) 96829   l 10000 k 10
recall: 0.96829
recall = cnt/float(l*k) 97018   l 10000 k 10
recall: 0.97018
recall = cnt/float(l*k) 97184   l 10000 k 10
recall: 0.97184
