maxelement,k,partitionnum,topkPartitionNum,ef,m,distanceFunction,kmeanstrainrate,efConstruction,usesift
 100000000 10 8 3 100 50 cosine 0.05 100 True
topkPartitionNum cmp 15
partitionnumreal,partitionnummap 8 40
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[20]
 [13]
 [13]
 [13]
 [28]] (1000000, 1) (1000000, 3)
centroids1.shape,centroids2.shape (8, 128) (40, 128)
centroids1 (8, 128)
centroids2 (40, 128)
40
len(repartitionres) 8
partitionnumreal,partitionnummap,len(partitionmap) 8 40 40
print(curdf[0]),curdf.shape (50000,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 80407   l 10000 k 10
recall: 0.80407
totalconstructtime 109890.28310775757 kmeanspartitiontime 9950.439453125 localindexconstructtime 98611.34552955627 globalindexconstructtime 1328.498125076294
totalsearchtime 13618.425846099854 localsearchtime 13544.211387634277 globalsearchtime 74.21445846557617
hello world testdoublekmeansHnsw

topkPartitionNum cmp 20
partitionnumreal,partitionnummap 8 40
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[20]
 [13]
 [13]
 [13]
 [28]] (1000000, 1) (1000000, 3)
centroids1.shape,centroids2.shape (8, 128) (40, 128)
centroids1 (8, 128)
centroids2 (40, 128)
40
len(repartitionres) 8
partitionnumreal,partitionnummap,len(partitionmap) 8 40 40
print(curdf[0]),curdf.shape (50000,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 84509   l 10000 k 10
recall: 0.84509
totalconstructtime 106491.62769317627 kmeanspartitiontime 8887.665033340454 localindexconstructtime 96270.83945274353 globalindexconstructtime 1333.1232070922852
totalsearchtime 12961.885452270508 localsearchtime 12884.666681289673 globalsearchtime 77.21877098083496
hello world testdoublekmeansHnsw

topkPartitionNum cmp 50
partitionnumreal,partitionnummap 8 40
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[20]
 [13]
 [13]
 [13]
 [28]] (1000000, 1) (1000000, 3)
centroids1.shape,centroids2.shape (8, 128) (40, 128)
centroids1 (8, 128)
centroids2 (40, 128)
40
len(repartitionres) 8
partitionnumreal,partitionnummap,len(partitionmap) 8 40 40
print(curdf[0]),curdf.shape (50000,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 93505   l 10000 k 10
recall: 0.93505
totalconstructtime 108221.48704528809 kmeanspartitiontime 9752.17056274414 localindexconstructtime 97128.82399559021 globalindexconstructtime 1340.4924869537354
totalsearchtime 14567.484140396118 localsearchtime 14493.068933486938 globalsearchtime 74.41520690917969
hello world testdoublekmeansHnsw

topkPartitionNum cmp 100
partitionnumreal,partitionnummap 8 40
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[20]
 [13]
 [13]
 [13]
 [28]] (1000000, 1) (1000000, 3)
centroids1.shape,centroids2.shape (8, 128) (40, 128)
centroids1 (8, 128)
centroids2 (40, 128)
40
len(repartitionres) 8
partitionnumreal,partitionnummap,len(partitionmap) 8 40 40
print(curdf[0]),curdf.shape (50000,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 97458   l 10000 k 10
recall: 0.97458
totalconstructtime 205458.27770233154 kmeanspartitiontime 8984.556913375854 localindexconstructtime 195143.73111724854 globalindexconstructtime 1329.9896717071533
totalsearchtime 18366.339206695557 localsearchtime 18291.651248931885 globalsearchtime 74.68795776367188
hello world testdoublekmeansHnsw

topkPartitionNum cmp 150
partitionnumreal,partitionnummap 8 40
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[20]
 [13]
 [13]
 [13]
 [28]] (1000000, 1) (1000000, 3)
centroids1.shape,centroids2.shape (8, 128) (40, 128)
centroids1 (8, 128)
centroids2 (40, 128)
40
len(repartitionres) 8
partitionnumreal,partitionnummap,len(partitionmap) 8 40 40
print(curdf[0]),curdf.shape (50000,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 97923   l 10000 k 10
recall: 0.97923
totalconstructtime 289599.44581985474 kmeanspartitiontime 8867.012023925781 localindexconstructtime 279392.8453922272 globalindexconstructtime 1339.5884037017822
totalsearchtime 22974.760055541992 localsearchtime 22897.218227386475 globalsearchtime 77.54182815551758
hello world testdoublekmeansHnsw

end topkPartitionNum cmp

maxelement = 100000000
k=10
partitionnum=8
topkPartitionNum=3

sc = 1
m = int(50)
distanceFunction='cosine'
kmeanstrainrate=0.05

efConstruction=35
ef = int(4*22)
usesift=True

kmeanspath="/aknn/kmeans/"

gistlist=["gistpartition.csv","gistcentroids2.csv","gistcentroids1.csv"]  
siftlist=["siftpartition.csv","siftcentroids1.csv","siftcentroids2.csv"]

"""
datapath="/my/siftsmall/"
traindatapath=datapath+"siftsmall_base.fvecs"
querydatapath=datapath+"siftsmall_query.fvecs"
querygroundtruthpath=datapath+"siftsmall_groundtruth.ivecs"
"""
datapath="/data/"
traindatapath=datapath+"sift_base.fvecs"
querydatapath=datapath+"sift_query.fvecs"
querygroundtruthpath=datapath+"sift_groundtruth.ivecs"


gistpath="/data/mnist.hdf5"
# ef=10, efConstruction=200


recall = cnt/float(l*k) 80407   l 10000 k 10
recall: 0.80407
recall = cnt/float(l*k) 84509   l 10000 k 10
recall: 0.84509
recall = cnt/float(l*k) 93505   l 10000 k 10
recall: 0.93505
recall = cnt/float(l*k) 97458   l 10000 k 10
recall: 0.97458
recall = cnt/float(l*k) 97923   l 10000 k 10
recall: 0.97923
