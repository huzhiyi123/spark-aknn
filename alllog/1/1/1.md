1.log
nohup bash /aknn/runall.sh 1.log &>cur1.log&


if __name__ == "__main__":
    initparams()
    print("start bruteForce\n")
    efConstruction=50
    ef = efConstruction
    #testdoublekmeansHnsw()
    bruteForce()
    print("end bruteForce\n")
    
    print("start efConstruction=250 \n")
    initparams()
    efConstruction=250
    ef = efConstruction
    print("start efConstruction=300 \n")
    initparams()
    efConstruction=300
    ef = efConstruction

    print("gist efConstruction \n")
    initparams()
    usesift = false
    efConstructionlist = [50,80,100,120,130,160,200,250,300]
    for i in efConstructionlist:
        efConstruction=300
        ef = efConstruction
        print("gist efConstruction cmp",efConstruction)
        testdoublekmeansHnsw()

# 6.log
nohup bash runall.sh 6.log &>>cur7.log&

if __name__ == "__main__":
    print("gist efConstruction \n")
    initparams()
    usesift = False
    testdoublekmeansHnswV2()
    efConstructionlist = [30,80,120,180,200,250]
    initparams()
    print("for i in efConstructionlist:")
    for i in efConstructionlist:
        initparams()
        efConstruction = i
        ef = efConstruction
        usesift = False
        print("efConstruction cmp gist",efConstruction)
        testdoublekmeansHnswV2()
    print("end efConstructionlist\n",efConstructionlist)


    topkPartitionNumlist = 8
    for i in range(1,9):
        initparams()
        topkPartitionNum=i
        efConstruction = 150
        ef = efConstruction
        usesift = False
        print("topkPartitionNumlist cmp",topkPartitionNum)
        testdoublekmeansHnsw()
        print("end topkPartitionNumlist cmp\n",topkPartitionNum)
    
    initparams()
    usesift = False
    bruteForce()

#  nohup bash /runall.sh 10.log  &>cur10.log &
## 22.log
if __name__ == "__main__":
    print("gist efConstruction \n")
    initparams()
    usesift = False
    efConstructionlist = [30,80,120,180,200,250]
    initparams()
    print("for i in efConstructionlist:")
    for i in efConstructionlist:
        initparams()
        efConstruction = i
        ef = efConstruction
        usesift = False
        print("efConstruction cmp gist",efConstruction)
        testdoublekmeansHnswV2()
    print("end efConstructionlist\n",efConstructionlist)
    

    topkPartitionNumlist = 8
    for i in range(1,9):
        initparams()
        topkPartitionNum=i
        efConstruction = 150
        ef = efConstruction
        usesift = False
        print("mnist topkPartitionNumlist cmp",topkPartitionNum)
        testdoublekmeansHnsw()
        print("end topkPartitionNumlist cmp\n",topkPartitionNum)
    
    klist = [5,10,15,20,30,40] 
    for ki in klist:
        initparams()
        usesift = False
        k=ki
        efConstruction = 150
        ef = efConstruction
        print("minist bruteForce klist = [5,10,15,20,30,50]   efConstruction = 150 usesift = False",ki)
        bruteForce()

    for ki in klist:
        initparams()
        k=ki
        efConstruction = 150
        ef = efConstruction
        print("gist bruteForce klist = [5,10,15,20,30,50]   efConstruction = 150 usesift = False",ki)
        bruteForce()

    for ki in klist:
        print("sift klist = [5,10,15,20,30,50]   efConstruction = 150 usesift = True",ki)
        initparams()
        k=ki
        efConstruction = 200
        ef = efConstruction
        testdoublekmeansHnswV2()

    for ki in klist:
        print("minist klist = [5,10,15,20,30,50]   efConstruction = 150 usesift = False",ki)
        initparams()
        usesift = False
        k=ki
        efConstruction = 200
        ef = efConstruction
        testdoublekmeansHnswV2()
    
# 29.log 暴力搜索k值


if __name__ == "__main__":
    print("gist efConstruction \n")
    initparams()
    #usesift = False
    klist = [10,20,30,40,50]
    for ki in klist:
        initparams()
        k=ki
        efConstruction = 150
        ef = efConstruction
        print("gist bruteForce klist = [5,10,20,30,40,50]   efConstruction = 150 usesift = False",ki)
        bruteForce()


# 4分区 准召率
4分区 8 分区 12分区 16分区


nohup bash runall.sh 30.log&>>cur30.log&
if __name__ == "__main__":
    print("gist efConstruction \n")
    initparams()
    #usesift = False
    klist = [10,20,30,40,50]
    efConstructionlist = [20,50,100,150,200,300]
    for i in efConstructionlist:
        print("for i in efConstructionlist: cmp",i)
        initparams()
        efConstruction = i
        ef = efConstruction
        testdoublekmeansHnswV2()
    for i in klist:
        print("for i in klist: cmp",i)
        initparams()
        k=i
        testdoublekmeansHnswV2()

# 31.log
4查3分区

# 34.log
   [20,100,200] 
四分区
    for i in efConstructionlist:
        print("for i in efConstructionlist: cmp",i)
        initparams()
        efConstruction = i
        ef = efConstruction
        testdoublekmeansHnswV2()
# 35.log 4分区 召回 吞吐

efConstructionlist = [15,50,80,150,300]#

# 37.log
efConstructionlist = [20,50,80,100,150,200]#[20,100,200]

# 38.log 分区裁剪 实验
if __name__ == "__main__":
    print("gist efConstruction \n")
    initparams()
    #usesift = False
    klist = [10,20,30,40,50]
    efConstructionlist = [20,50,80,100,150,200]#[20,100,200]
    topkPartitionNumlist = 4
    for i in range(1,5):
        initparams()
        topkPartitionNum=i
        efConstruction = 150
        ef = efConstruction
        print("topkPartitionNumlist cmp",topkPartitionNum)
        testdoublekmeansHnsw()
    print("end topkPartitionNumlist cmp\n",topkPartitionNum)


# 39.log minist
准召率
if __name__ == "__main__":
    print("gist efConstruction \n")
    initparams()
    #usesift = False
    klist = [10,20,30,40,50]
    efConstructionlist = [20,100,200] #[20,50,80,100,150,200]#[20,100,200]
    topkPartitionNumlist = 4
    for i in efConstructionlist:
        initparams()
        topkPartitionNum=3
        efConstruction = i
        ef = efConstruction
        usesift = False
        print("efConstructionlist cmp",efConstruction)
        testdoublekmeansHnsw()
    print("end efConstructionlist cmp\n",efConstruction)

# 4fenqu k比较 40log
root@master:/aknn# nohup bash runall.sh 40.log &>>curlog/40.log&

if __name__ == "__main__":
    print("gist efConstruction \n")
    initparams()
    #usesift = False
    klist = [5,10,20,30,40,50]
    for i in klist:
        initparams()
        topkPartitionNum=3
        efConstruction = 100
        ef = efConstruction
        usesift = False
        k=i
        print("klist cmp",k)
        testdoublekmeansHnswV2()
    print("end klist cmp\n",k)

# 重新8分区 ef和k
nohup bash runall.sh 41.log &>>curlog/41.log&


# root@master:/aknn# nohup bash runall.sh 42.log &>>curlog/42.log&
8分区分区裁剪


# 42-44 8分区 
分区裁剪和暴力

# 16分区ef实验
if __name__ == "__main__":
    rate = 5
    initparams()
    print("maxelement,k,partitionnum,topkPartitionNum,ef,m,distanceFunction,kmeanstrainrate,efConstruction,usesift\n",
    maxelement,k,partitionnum,topkPartitionNum,ef,m,distanceFunction,kmeanstrainrate,efConstruction,usesift)
    #usesift = False
    efConstructionlist = [15,20,50,100,150]
    # efConstructionlist = [12,15,18,20,30,50,100,200]
    for i in efConstructionlist:
        initparams()
        efConstruction = i
        ef = efConstruction
        usesift = True
        print("topkPartitionNum cmp",i)
        testdoublekmeansHnswV2()
    print("end topkPartitionNum cmp\n")


# 46.log  单core ef 4分区

# 46.log -49.log 4 6 8 10分区