gist efConstruction 

for i in efConstructionlist: cmp 20
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[13]
 [13]
 [13]
 [28]
 [21]] (1000000, 1) (1000000, 3)
centroids1 (4, 128)
centroids2 (40, 128)
print(curdf[0]),curdf.shape (50000,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 69288   l 10000 k 10
recall: 0.69288
totalconstructtime 226773.02169799805 kmeanspartitiontime 9963.070631027222 localindexconstructtime 214914.9079322815 globalindexconstructtime 1895.043134689331
totalsearchtime 14220.576047897339 localsearchtime 14080.888271331787 globalsearchtime 139.68777656555176
hello world testdoublekmeansHnsw

for i in efConstructionlist: cmp 50
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[13]
 [13]
 [13]
 [28]
 [21]] (1000000, 1) (1000000, 3)
centroids1 (4, 128)
centroids2 (40, 128)
print(curdf[0]),curdf.shape (50000,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 75714   l 10000 k 10
recall: 0.75714
totalconstructtime 270751.9528865814 kmeanspartitiontime 11272.613763809204 localindexconstructtime 257575.82211494446 globalindexconstructtime 1903.5170078277588
totalsearchtime 18979.623556137085 localsearchtime 18844.01798248291 globalsearchtime 135.6055736541748
hello world testdoublekmeansHnsw

for i in efConstructionlist: cmp 100
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[13]
 [13]
 [13]
 [28]
 [21]] (1000000, 1) (1000000, 3)
centroids1 (4, 128)
centroids2 (40, 128)
print(curdf[0]),curdf.shape (50000,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 77990   l 10000 k 10
recall: 0.7799
totalconstructtime 538693.2022571564 kmeanspartitiontime 12686.450242996216 localindexconstructtime 524091.21346473694 globalindexconstructtime 1915.5385494232178
totalsearchtime 29081.289529800415 localsearchtime 28934.622287750244 globalsearchtime 146.6672420501709
hello world testdoublekmeansHnsw

for i in efConstructionlist: cmp 150
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[13]
 [13]
 [13]
 [28]
 [21]] (1000000, 1) (1000000, 3)
centroids1 (4, 128)
centroids2 (40, 128)
print(curdf[0]),curdf.shape (50000,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 78256   l 10000 k 10
recall: 0.78256
totalconstructtime 785188.4021759033 kmeanspartitiontime 11163.772583007812 localindexconstructtime 772103.5349369049 globalindexconstructtime 1921.0946559906006
totalsearchtime 39011.393785476685 localsearchtime 38865.657329559326 globalsearchtime 145.7364559173584
hello world testdoublekmeansHnsw

for i in efConstructionlist: cmp 200
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[13]
 [13]
 [13]
 [28]
 [21]] (1000000, 1) (1000000, 3)
centroids1 (4, 128)
centroids2 (40, 128)
print(curdf[0]),curdf.shape (50000,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 78211   l 10000 k 10
recall: 0.78211
totalconstructtime 985817.7869319916 kmeanspartitiontime 11276.934385299683 localindexconstructtime 972870.9859848022 globalindexconstructtime 1669.8665618896484
totalsearchtime 42689.68653678894 localsearchtime 42580.695152282715 globalsearchtime 108.99138450622559
hello world testdoublekmeansHnsw

for i in efConstructionlist: cmp 300
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[13]
 [13]
 [13]
 [28]
 [21]] (1000000, 1) (1000000, 3)
centroids1 (4, 128)
centroids2 (40, 128)
print(curdf[0]),curdf.shape (50000,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 77969   l 10000 k 10
recall: 0.77969
totalconstructtime 1191937.1440410614 kmeanspartitiontime 9745.176315307617 localindexconstructtime 1180375.539779663 globalindexconstructtime 1816.4279460906982
totalsearchtime 60672.68371582031 localsearchtime 60545.88437080383 globalsearchtime 126.79934501647949
hello world testdoublekmeansHnsw

maxelement = 100000000
k=10
partitionnum=8
topkPartitionNum=3

sc = 1
m = int(50)
distanceFunction='cosine'
kmeanstrainrate=0.05

efConstruction=35
ef = int(4*22)
usesift=True

kmeanspath="/aknn/kmeans/"

gistlist=["gistpartition.csv","gistcentroids2.csv","gistcentroids1.csv"]  
siftlist=["siftpartition.csv","siftcentroids1.csv","siftcentroids2.csv"]

"""
datapath="/my/siftsmall/"
traindatapath=datapath+"siftsmall_base.fvecs"
querydatapath=datapath+"siftsmall_query.fvecs"
querygroundtruthpath=datapath+"siftsmall_groundtruth.ivecs"
"""
datapath="/data/"
traindatapath=datapath+"sift_base.fvecs"
querydatapath=datapath+"sift_query.fvecs"
querygroundtruthpath=datapath+"sift_groundtruth.ivecs"


gistpath="/data/mnist.hdf5"
# ef=10, efConstruction=200


def initparams():
    global maxelement,k,partitionnum,topkPartitionNum,ef,m,distanceFunction,kmeanstrainraten,efConstruction,usesift
    maxelement = 100000000
    k=10
    partitionnum=4
    topkPartitionNum=3
    sc = 1
    m = int(50)
    distanceFunction='cosine'
    kmeanstrainrate=0.05
    efConstruction=85
    ef = efConstruction
    usesift=Truerecall = cnt/float(l*k) 69288   l 10000 k 10
recall: 0.69288
recall = cnt/float(l*k) 75714   l 10000 k 10
recall: 0.75714
recall = cnt/float(l*k) 77990   l 10000 k 10
recall: 0.7799
recall = cnt/float(l*k) 78256   l 10000 k 10
recall: 0.78256
recall = cnt/float(l*k) 78211   l 10000 k 10
recall: 0.78211
recall = cnt/float(l*k) 77969   l 10000 k 10
recall: 0.77969
