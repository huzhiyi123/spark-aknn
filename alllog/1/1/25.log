gist efConstruction 

for i in efConstructionlist:
efConstruction cmp gist 30
<class 'h5py._hl.files.File'>
<KeysViewHDF5 ['distances', 'neighbors', 'test', 'train']>
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[31]
 [43]
 [28]
 [33]
 [44]] (60000, 1) (60000, 3)
centroids1 (8, 784)
centroids2 (80, 784)
print(curdf[0]),curdf.shape (2999,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 39077   l 10000 k 10
recall: 0.39077
totalconstructtime 31970.222234725952 kmeanspartitiontime 2454.9365043640137 localindexconstructtime 29302.719116210938 globalindexconstructtime 212.56661415100098
totalsearchtime 11778.674125671387 localsearchtime 11634.230375289917 globalsearchtime 144.44375038146973
hello world testdoublekmeansHnsw

efConstruction cmp gist 80
<class 'h5py._hl.files.File'>
<KeysViewHDF5 ['distances', 'neighbors', 'test', 'train']>
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[31]
 [43]
 [28]
 [33]
 [44]] (60000, 1) (60000, 3)
centroids1 (8, 784)
centroids2 (80, 784)
print(curdf[0]),curdf.shape (2999,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 39073   l 10000 k 10
recall: 0.39073
totalconstructtime 31183.261156082153 kmeanspartitiontime 2265.906572341919 localindexconstructtime 28702.921628952026 globalindexconstructtime 214.432954788208
totalsearchtime 16642.044067382812 localsearchtime 16514.586687088013 globalsearchtime 127.4573802947998
hello world testdoublekmeansHnsw

efConstruction cmp gist 120
<class 'h5py._hl.files.File'>
<KeysViewHDF5 ['distances', 'neighbors', 'test', 'train']>
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[31]
 [43]
 [28]
 [33]
 [44]] (60000, 1) (60000, 3)
centroids1 (8, 784)
centroids2 (80, 784)
print(curdf[0]),curdf.shape (2999,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 39029   l 10000 k 10
recall: 0.39029
totalconstructtime 33372.915506362915 kmeanspartitiontime 2195.622205734253 localindexconstructtime 30966.311931610107 globalindexconstructtime 210.9813690185547
totalsearchtime 19863.789081573486 localsearchtime 19725.515604019165 globalsearchtime 138.2734775543213
hello world testdoublekmeansHnsw

efConstruction cmp gist 180
<class 'h5py._hl.files.File'>
<KeysViewHDF5 ['distances', 'neighbors', 'test', 'train']>
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[31]
 [43]
 [28]
 [33]
 [44]] (60000, 1) (60000, 3)
centroids1 (8, 784)
centroids2 (80, 784)
print(curdf[0]),curdf.shape (2999,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 39084   l 10000 k 10
recall: 0.39084
totalconstructtime 34506.62398338318 kmeanspartitiontime 1944.4799423217773 localindexconstructtime 32345.557928085327 globalindexconstructtime 216.58611297607422
totalsearchtime 24703.144788742065 localsearchtime 24571.041584014893 globalsearchtime 132.10320472717285
hello world testdoublekmeansHnsw

efConstruction cmp gist 200
<class 'h5py._hl.files.File'>
<KeysViewHDF5 ['distances', 'neighbors', 'test', 'train']>
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[31]
 [43]
 [28]
 [33]
 [44]] (60000, 1) (60000, 3)
centroids1 (8, 784)
centroids2 (80, 784)
print(curdf[0]),curdf.shape (2999,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 39078   l 10000 k 10
recall: 0.39078
totalconstructtime 36355.205059051514 kmeanspartitiontime 2079.458236694336 localindexconstructtime 34052.85096168518 globalindexconstructtime 222.89586067199707
totalsearchtime 26767.4777507782 localsearchtime 26637.943744659424 globalsearchtime 129.5340061187744
hello world testdoublekmeansHnsw

efConstruction cmp gist 250
<class 'h5py._hl.files.File'>
<KeysViewHDF5 ['distances', 'neighbors', 'test', 'train']>
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[31]
 [43]
 [28]
 [33]
 [44]] (60000, 1) (60000, 3)
centroids1 (8, 784)
centroids2 (80, 784)
print(curdf[0]),curdf.shape (2999,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 39113   l 10000 k 10
recall: 0.39113
totalconstructtime 42673.03442955017 kmeanspartitiontime 2379.9760341644287 localindexconstructtime 40083.2257270813 globalindexconstructtime 209.83266830444336
totalsearchtime 30817.103624343872 localsearchtime 30681.434392929077 globalsearchtime 135.66923141479492
hello world testdoublekmeansHnsw

end efConstructionlist
 [30, 80, 120, 180, 200, 250]
maxelement = 100000000
k=10
partitionnum=8
topkPartitionNum=3

sc = 1
m = int(50)
distanceFunction='cosine'
kmeanstrainrate=0.05

efConstruction=35
ef = int(4*22)
usesift=True

kmeanspath="/aknn/kmeans/"

gistlist=["gistpartition.csv","gistcentroids2.csv","gistcentroids1.csv"]  
siftlist=["siftpartition.csv","siftcentroids1.csv","siftcentroids2.csv"]

"""
datapath="/my/siftsmall/"
traindatapath=datapath+"siftsmall_base.fvecs"
querydatapath=datapath+"siftsmall_query.fvecs"
querygroundtruthpath=datapath+"siftsmall_groundtruth.ivecs"
"""
datapath="/data/"
traindatapath=datapath+"sift_base.fvecs"
querydatapath=datapath+"sift_query.fvecs"
querygroundtruthpath=datapath+"sift_groundtruth.ivecs"


gistpath="/data/mnist.hdf5"
# ef=10, efConstruction=200


def initparams():
    global maxelement,k,partitionnum,topkPartitionNum,ef,m,distanceFunction,kmeanstrainraten,efConstruction,usesift
    maxelement = 100000000
    k=10
    partitionnum=8
    topkPartitionNum=5
    
    sc = 1
    m = int(50)
    distanceFunction='cosine'
    kmeanstrainrate=0.05
    efConstruction=85
    ef = efConstruction
    usesift=Truerecall = cnt/float(l*k) 39077   l 10000 k 10
recall: 0.39077
recall = cnt/float(l*k) 39073   l 10000 k 10
recall: 0.39073
recall = cnt/float(l*k) 39029   l 10000 k 10
recall: 0.39029
recall = cnt/float(l*k) 39084   l 10000 k 10
recall: 0.39084
recall = cnt/float(l*k) 39078   l 10000 k 10
recall: 0.39078
recall = cnt/float(l*k) 39113   l 10000 k 10
recall: 0.39113
