maxelement,k,partitionnum,topkPartitionNum,ef,m,distanceFunction,kmeanstrainrate,efConstruction,usesift
 100000000 10 4 3 100 50 cosine 0.05 100 True
topkPartitionNum cmp 15
partitionnumreal,partitionnummap 4 20
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[7]
 [7]
 [7]
 [7]
 [2]] (1000000, 1) (1000000, 3)
centroids1.shape,centroids2.shape (4, 128) (20, 128)
centroids1 (4, 128)
centroids2 (20, 128)
20
len(repartitionres) 4
partitionnumreal,partitionnummap,len(partitionmap) 4 20 20
print(curdf[0]),curdf.shape (49999,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 79242   l 10000 k 10
recall: 0.79242
totalconstructtime 190776.92985534668 kmeanspartitiontime 9181.964635848999 localindexconstructtime 180281.7440032959 globalindexconstructtime 1313.2212162017822
totalsearchtime 12627.326250076294 localsearchtime 12552.385091781616 globalsearchtime 74.94115829467773
hello world testdoublekmeansHnsw

topkPartitionNum cmp 20
partitionnumreal,partitionnummap 4 20
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[7]
 [7]
 [7]
 [7]
 [2]] (1000000, 1) (1000000, 3)
centroids1.shape,centroids2.shape (4, 128) (20, 128)
centroids1 (4, 128)
centroids2 (20, 128)
20
len(repartitionres) 4
partitionnumreal,partitionnummap,len(partitionmap) 4 20 20
print(curdf[0]),curdf.shape (49999,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 83855   l 10000 k 10
recall: 0.83855
totalconstructtime 198897.12810516357 kmeanspartitiontime 8377.05945968628 localindexconstructtime 189200.65093040466 globalindexconstructtime 1319.4177150726318
totalsearchtime 12581.13145828247 localsearchtime 12507.218360900879 globalsearchtime 73.9130973815918
hello world testdoublekmeansHnsw

topkPartitionNum cmp 50
partitionnumreal,partitionnummap 4 20
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[7]
 [7]
 [7]
 [7]
 [2]] (1000000, 1) (1000000, 3)
centroids1.shape,centroids2.shape (4, 128) (20, 128)
centroids1 (4, 128)
centroids2 (20, 128)
20
len(repartitionres) 4
partitionnumreal,partitionnummap,len(partitionmap) 4 20 20
print(curdf[0]),curdf.shape (49999,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 93558   l 10000 k 10
recall: 0.93558
totalconstructtime 195067.91472434998 kmeanspartitiontime 9543.052196502686 localindexconstructtime 184206.3374519348 globalindexconstructtime 1318.5250759124756
totalsearchtime 15141.392946243286 localsearchtime 15067.421674728394 globalsearchtime 73.97127151489258
hello world testdoublekmeansHnsw

topkPartitionNum cmp 100
partitionnumreal,partitionnummap 4 20
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[7]
 [7]
 [7]
 [7]
 [2]] (1000000, 1) (1000000, 3)
centroids1.shape,centroids2.shape (4, 128) (20, 128)
centroids1 (4, 128)
centroids2 (20, 128)
20
len(repartitionres) 4
partitionnumreal,partitionnummap,len(partitionmap) 4 20 20
print(curdf[0]),curdf.shape (49999,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 98325   l 10000 k 10
recall: 0.98325
totalconstructtime 391398.4866142273 kmeanspartitiontime 8321.032762527466 localindexconstructtime 381757.1144104004 globalindexconstructtime 1320.3394412994385
totalsearchtime 21283.632278442383 localsearchtime 21207.077264785767 globalsearchtime 76.55501365661621
hello world testdoublekmeansHnsw

topkPartitionNum cmp 150
partitionnumreal,partitionnummap 4 20
type(tmp),tmp[0:100],tmp.shape <class 'numpy.ndarray'> [[7]
 [7]
 [7]
 [7]
 [2]] (1000000, 1) (1000000, 3)
centroids1.shape,centroids2.shape (4, 128) (20, 128)
centroids1 (4, 128)
centroids2 (20, 128)
20
len(repartitionres) 4
partitionnumreal,partitionnummap,len(partitionmap) 4 20 20
print(curdf[0]),curdf.shape (49999,) <class 'pandas.core.series.Series'>
start query
result.count() 10000
end query
l 10000 k 10
recall = cnt/float(l*k) 98952   l 10000 k 10
recall: 0.98952
totalconstructtime 585251.6288757324 kmeanspartitiontime 9674.150466918945 localindexconstructtime 574255.4874420166 globalindexconstructtime 1321.990966796875
totalsearchtime 27694.811582565308 localsearchtime 27619.47727203369 globalsearchtime 75.33431053161621
hello world testdoublekmeansHnsw

end topkPartitionNum cmp

maxelement = 100000000
k=10
partitionnum=8
topkPartitionNum=3

sc = 1
m = int(50)
distanceFunction='cosine'
kmeanstrainrate=0.05

efConstruction=35
ef = int(4*22)
usesift=True

kmeanspath="/aknn/kmeans/"

gistlist=["gistpartition.csv","gistcentroids2.csv","gistcentroids1.csv"]  
siftlist=["siftpartition.csv","siftcentroids1.csv","siftcentroids2.csv"]

"""
datapath="/my/siftsmall/"
traindatapath=datapath+"siftsmall_base.fvecs"
querydatapath=datapath+"siftsmall_query.fvecs"
querygroundtruthpath=datapath+"siftsmall_groundtruth.ivecs"
"""
datapath="/data/"
traindatapath=datapath+"sift_base.fvecs"
querydatapath=datapath+"sift_query.fvecs"
querygroundtruthpath=datapath+"sift_groundtruth.ivecs"


gistpath="/data/mnist.hdf5"
# ef=10, efConstruction=200


recall = cnt/float(l*k) 79242   l 10000 k 10
recall: 0.79242
recall = cnt/float(l*k) 83855   l 10000 k 10
recall: 0.83855
recall = cnt/float(l*k) 93558   l 10000 k 10
recall: 0.93558
recall = cnt/float(l*k) 98325   l 10000 k 10
recall: 0.98325
recall = cnt/float(l*k) 98952   l 10000 k 10
recall: 0.98952
